{"ast":null,"code":"var bigInt = function (undefined) {\n  \"use strict\";\n\n  var BASE = 1e7,\n      LOG_BASE = 7,\n      MAX_INT = 9007199254740992,\n      MAX_INT_ARR = smallToArray(MAX_INT),\n      DEFAULT_ALPHABET = \"0123456789abcdefghijklmnopqrstuvwxyz\";\n  var supportsNativeBigInt = typeof BigInt === \"function\";\n\n  function Integer(v, radix, alphabet, caseSensitive) {\n    if (typeof v === \"undefined\") return Integer[0];\n    if (typeof radix !== \"undefined\") return +radix === 10 && !alphabet ? parseValue(v) : parseBase(v, radix, alphabet, caseSensitive);\n    return parseValue(v);\n  }\n\n  function BigInteger(value, sign) {\n    this.value = value;\n    this.sign = sign;\n    this.isSmall = false;\n  }\n\n  BigInteger.prototype = Object.create(Integer.prototype);\n\n  function SmallInteger(value) {\n    this.value = value;\n    this.sign = value < 0;\n    this.isSmall = true;\n  }\n\n  SmallInteger.prototype = Object.create(Integer.prototype);\n\n  function NativeBigInt(value) {\n    this.value = value;\n  }\n\n  NativeBigInt.prototype = Object.create(Integer.prototype);\n\n  function isPrecise(n) {\n    return -MAX_INT < n && n < MAX_INT;\n  }\n\n  function smallToArray(n) {\n    // For performance reasons doesn't reference BASE, need to change this function if BASE changes\n    if (n < 1e7) return [n];\n    if (n < 1e14) return [n % 1e7, Math.floor(n / 1e7)];\n    return [n % 1e7, Math.floor(n / 1e7) % 1e7, Math.floor(n / 1e14)];\n  }\n\n  function arrayToSmall(arr) {\n    // If BASE changes this function may need to change\n    trim(arr);\n    var length = arr.length;\n\n    if (length < 4 && compareAbs(arr, MAX_INT_ARR) < 0) {\n      switch (length) {\n        case 0:\n          return 0;\n\n        case 1:\n          return arr[0];\n\n        case 2:\n          return arr[0] + arr[1] * BASE;\n\n        default:\n          return arr[0] + (arr[1] + arr[2] * BASE) * BASE;\n      }\n    }\n\n    return arr;\n  }\n\n  function trim(v) {\n    var i = v.length;\n\n    while (v[--i] === 0);\n\n    v.length = i + 1;\n  }\n\n  function createArray(length) {\n    // function shamelessly stolen from Yaffle's library https://github.com/Yaffle/BigInteger\n    var x = new Array(length);\n    var i = -1;\n\n    while (++i < length) {\n      x[i] = 0;\n    }\n\n    return x;\n  }\n\n  function truncate(n) {\n    if (n > 0) return Math.floor(n);\n    return Math.ceil(n);\n  }\n\n  function add(a, b) {\n    // assumes a and b are arrays with a.length >= b.length\n    var l_a = a.length,\n        l_b = b.length,\n        r = new Array(l_a),\n        carry = 0,\n        base = BASE,\n        sum,\n        i;\n\n    for (i = 0; i < l_b; i++) {\n      sum = a[i] + b[i] + carry;\n      carry = sum >= base ? 1 : 0;\n      r[i] = sum - carry * base;\n    }\n\n    while (i < l_a) {\n      sum = a[i] + carry;\n      carry = sum === base ? 1 : 0;\n      r[i++] = sum - carry * base;\n    }\n\n    if (carry > 0) r.push(carry);\n    return r;\n  }\n\n  function addAny(a, b) {\n    if (a.length >= b.length) return add(a, b);\n    return add(b, a);\n  }\n\n  function addSmall(a, carry) {\n    // assumes a is array, carry is number with 0 <= carry < MAX_INT\n    var l = a.length,\n        r = new Array(l),\n        base = BASE,\n        sum,\n        i;\n\n    for (i = 0; i < l; i++) {\n      sum = a[i] - base + carry;\n      carry = Math.floor(sum / base);\n      r[i] = sum - carry * base;\n      carry += 1;\n    }\n\n    while (carry > 0) {\n      r[i++] = carry % base;\n      carry = Math.floor(carry / base);\n    }\n\n    return r;\n  }\n\n  BigInteger.prototype.add = function (v) {\n    var n = parseValue(v);\n\n    if (this.sign !== n.sign) {\n      return this.subtract(n.negate());\n    }\n\n    var a = this.value,\n        b = n.value;\n\n    if (n.isSmall) {\n      return new BigInteger(addSmall(a, Math.abs(b)), this.sign);\n    }\n\n    return new BigInteger(addAny(a, b), this.sign);\n  };\n\n  BigInteger.prototype.plus = BigInteger.prototype.add;\n\n  SmallInteger.prototype.add = function (v) {\n    var n = parseValue(v);\n    var a = this.value;\n\n    if (a < 0 !== n.sign) {\n      return this.subtract(n.negate());\n    }\n\n    var b = n.value;\n\n    if (n.isSmall) {\n      if (isPrecise(a + b)) return new SmallInteger(a + b);\n      b = smallToArray(Math.abs(b));\n    }\n\n    return new BigInteger(addSmall(b, Math.abs(a)), a < 0);\n  };\n\n  SmallInteger.prototype.plus = SmallInteger.prototype.add;\n\n  NativeBigInt.prototype.add = function (v) {\n    return new NativeBigInt(this.value + parseValue(v).value);\n  };\n\n  NativeBigInt.prototype.plus = NativeBigInt.prototype.add;\n\n  function subtract(a, b) {\n    // assumes a and b are arrays with a >= b\n    var a_l = a.length,\n        b_l = b.length,\n        r = new Array(a_l),\n        borrow = 0,\n        base = BASE,\n        i,\n        difference;\n\n    for (i = 0; i < b_l; i++) {\n      difference = a[i] - borrow - b[i];\n\n      if (difference < 0) {\n        difference += base;\n        borrow = 1;\n      } else borrow = 0;\n\n      r[i] = difference;\n    }\n\n    for (i = b_l; i < a_l; i++) {\n      difference = a[i] - borrow;\n      if (difference < 0) difference += base;else {\n        r[i++] = difference;\n        break;\n      }\n      r[i] = difference;\n    }\n\n    for (; i < a_l; i++) {\n      r[i] = a[i];\n    }\n\n    trim(r);\n    return r;\n  }\n\n  function subtractAny(a, b, sign) {\n    var value;\n\n    if (compareAbs(a, b) >= 0) {\n      value = subtract(a, b);\n    } else {\n      value = subtract(b, a);\n      sign = !sign;\n    }\n\n    value = arrayToSmall(value);\n\n    if (typeof value === \"number\") {\n      if (sign) value = -value;\n      return new SmallInteger(value);\n    }\n\n    return new BigInteger(value, sign);\n  }\n\n  function subtractSmall(a, b, sign) {\n    // assumes a is array, b is number with 0 <= b < MAX_INT\n    var l = a.length,\n        r = new Array(l),\n        carry = -b,\n        base = BASE,\n        i,\n        difference;\n\n    for (i = 0; i < l; i++) {\n      difference = a[i] + carry;\n      carry = Math.floor(difference / base);\n      difference %= base;\n      r[i] = difference < 0 ? difference + base : difference;\n    }\n\n    r = arrayToSmall(r);\n\n    if (typeof r === \"number\") {\n      if (sign) r = -r;\n      return new SmallInteger(r);\n    }\n\n    return new BigInteger(r, sign);\n  }\n\n  BigInteger.prototype.subtract = function (v) {\n    var n = parseValue(v);\n\n    if (this.sign !== n.sign) {\n      return this.add(n.negate());\n    }\n\n    var a = this.value,\n        b = n.value;\n    if (n.isSmall) return subtractSmall(a, Math.abs(b), this.sign);\n    return subtractAny(a, b, this.sign);\n  };\n\n  BigInteger.prototype.minus = BigInteger.prototype.subtract;\n\n  SmallInteger.prototype.subtract = function (v) {\n    var n = parseValue(v);\n    var a = this.value;\n\n    if (a < 0 !== n.sign) {\n      return this.add(n.negate());\n    }\n\n    var b = n.value;\n\n    if (n.isSmall) {\n      return new SmallInteger(a - b);\n    }\n\n    return subtractSmall(b, Math.abs(a), a >= 0);\n  };\n\n  SmallInteger.prototype.minus = SmallInteger.prototype.subtract;\n\n  NativeBigInt.prototype.subtract = function (v) {\n    return new NativeBigInt(this.value - parseValue(v).value);\n  };\n\n  NativeBigInt.prototype.minus = NativeBigInt.prototype.subtract;\n\n  BigInteger.prototype.negate = function () {\n    return new BigInteger(this.value, !this.sign);\n  };\n\n  SmallInteger.prototype.negate = function () {\n    var sign = this.sign;\n    var small = new SmallInteger(-this.value);\n    small.sign = !sign;\n    return small;\n  };\n\n  NativeBigInt.prototype.negate = function () {\n    return new NativeBigInt(-this.value);\n  };\n\n  BigInteger.prototype.abs = function () {\n    return new BigInteger(this.value, false);\n  };\n\n  SmallInteger.prototype.abs = function () {\n    return new SmallInteger(Math.abs(this.value));\n  };\n\n  NativeBigInt.prototype.abs = function () {\n    return new NativeBigInt(this.value >= 0 ? this.value : -this.value);\n  };\n\n  function multiplyLong(a, b) {\n    var a_l = a.length,\n        b_l = b.length,\n        l = a_l + b_l,\n        r = createArray(l),\n        base = BASE,\n        product,\n        carry,\n        i,\n        a_i,\n        b_j;\n\n    for (i = 0; i < a_l; ++i) {\n      a_i = a[i];\n\n      for (var j = 0; j < b_l; ++j) {\n        b_j = b[j];\n        product = a_i * b_j + r[i + j];\n        carry = Math.floor(product / base);\n        r[i + j] = product - carry * base;\n        r[i + j + 1] += carry;\n      }\n    }\n\n    trim(r);\n    return r;\n  }\n\n  function multiplySmall(a, b) {\n    // assumes a is array, b is number with |b| < BASE\n    var l = a.length,\n        r = new Array(l),\n        base = BASE,\n        carry = 0,\n        product,\n        i;\n\n    for (i = 0; i < l; i++) {\n      product = a[i] * b + carry;\n      carry = Math.floor(product / base);\n      r[i] = product - carry * base;\n    }\n\n    while (carry > 0) {\n      r[i++] = carry % base;\n      carry = Math.floor(carry / base);\n    }\n\n    return r;\n  }\n\n  function shiftLeft(x, n) {\n    var r = [];\n\n    while (n-- > 0) r.push(0);\n\n    return r.concat(x);\n  }\n\n  function multiplyKaratsuba(x, y) {\n    var n = Math.max(x.length, y.length);\n    if (n <= 30) return multiplyLong(x, y);\n    n = Math.ceil(n / 2);\n    var b = x.slice(n),\n        a = x.slice(0, n),\n        d = y.slice(n),\n        c = y.slice(0, n);\n    var ac = multiplyKaratsuba(a, c),\n        bd = multiplyKaratsuba(b, d),\n        abcd = multiplyKaratsuba(addAny(a, b), addAny(c, d));\n    var product = addAny(addAny(ac, shiftLeft(subtract(subtract(abcd, ac), bd), n)), shiftLeft(bd, 2 * n));\n    trim(product);\n    return product;\n  } // The following function is derived from a surface fit of a graph plotting the performance difference\n  // between long multiplication and karatsuba multiplication versus the lengths of the two arrays.\n\n\n  function useKaratsuba(l1, l2) {\n    return -0.012 * l1 - 0.012 * l2 + 0.000015 * l1 * l2 > 0;\n  }\n\n  BigInteger.prototype.multiply = function (v) {\n    var n = parseValue(v),\n        a = this.value,\n        b = n.value,\n        sign = this.sign !== n.sign,\n        abs;\n\n    if (n.isSmall) {\n      if (b === 0) return Integer[0];\n      if (b === 1) return this;\n      if (b === -1) return this.negate();\n      abs = Math.abs(b);\n\n      if (abs < BASE) {\n        return new BigInteger(multiplySmall(a, abs), sign);\n      }\n\n      b = smallToArray(abs);\n    }\n\n    if (useKaratsuba(a.length, b.length)) // Karatsuba is only faster for certain array sizes\n      return new BigInteger(multiplyKaratsuba(a, b), sign);\n    return new BigInteger(multiplyLong(a, b), sign);\n  };\n\n  BigInteger.prototype.times = BigInteger.prototype.multiply;\n\n  function multiplySmallAndArray(a, b, sign) {\n    // a >= 0\n    if (a < BASE) {\n      return new BigInteger(multiplySmall(b, a), sign);\n    }\n\n    return new BigInteger(multiplyLong(b, smallToArray(a)), sign);\n  }\n\n  SmallInteger.prototype._multiplyBySmall = function (a) {\n    if (isPrecise(a.value * this.value)) {\n      return new SmallInteger(a.value * this.value);\n    }\n\n    return multiplySmallAndArray(Math.abs(a.value), smallToArray(Math.abs(this.value)), this.sign !== a.sign);\n  };\n\n  BigInteger.prototype._multiplyBySmall = function (a) {\n    if (a.value === 0) return Integer[0];\n    if (a.value === 1) return this;\n    if (a.value === -1) return this.negate();\n    return multiplySmallAndArray(Math.abs(a.value), this.value, this.sign !== a.sign);\n  };\n\n  SmallInteger.prototype.multiply = function (v) {\n    return parseValue(v)._multiplyBySmall(this);\n  };\n\n  SmallInteger.prototype.times = SmallInteger.prototype.multiply;\n\n  NativeBigInt.prototype.multiply = function (v) {\n    return new NativeBigInt(this.value * parseValue(v).value);\n  };\n\n  NativeBigInt.prototype.times = NativeBigInt.prototype.multiply;\n\n  function square(a) {\n    //console.assert(2 * BASE * BASE < MAX_INT);\n    var l = a.length,\n        r = createArray(l + l),\n        base = BASE,\n        product,\n        carry,\n        i,\n        a_i,\n        a_j;\n\n    for (i = 0; i < l; i++) {\n      a_i = a[i];\n      carry = 0 - a_i * a_i;\n\n      for (var j = i; j < l; j++) {\n        a_j = a[j];\n        product = 2 * (a_i * a_j) + r[i + j] + carry;\n        carry = Math.floor(product / base);\n        r[i + j] = product - carry * base;\n      }\n\n      r[i + l] = carry;\n    }\n\n    trim(r);\n    return r;\n  }\n\n  BigInteger.prototype.square = function () {\n    return new BigInteger(square(this.value), false);\n  };\n\n  SmallInteger.prototype.square = function () {\n    var value = this.value * this.value;\n    if (isPrecise(value)) return new SmallInteger(value);\n    return new BigInteger(square(smallToArray(Math.abs(this.value))), false);\n  };\n\n  NativeBigInt.prototype.square = function (v) {\n    return new NativeBigInt(this.value * this.value);\n  };\n\n  function divMod1(a, b) {\n    // Left over from previous version. Performs faster than divMod2 on smaller input sizes.\n    var a_l = a.length,\n        b_l = b.length,\n        base = BASE,\n        result = createArray(b.length),\n        divisorMostSignificantDigit = b[b_l - 1],\n        // normalization\n    lambda = Math.ceil(base / (2 * divisorMostSignificantDigit)),\n        remainder = multiplySmall(a, lambda),\n        divisor = multiplySmall(b, lambda),\n        quotientDigit,\n        shift,\n        carry,\n        borrow,\n        i,\n        l,\n        q;\n    if (remainder.length <= a_l) remainder.push(0);\n    divisor.push(0);\n    divisorMostSignificantDigit = divisor[b_l - 1];\n\n    for (shift = a_l - b_l; shift >= 0; shift--) {\n      quotientDigit = base - 1;\n\n      if (remainder[shift + b_l] !== divisorMostSignificantDigit) {\n        quotientDigit = Math.floor((remainder[shift + b_l] * base + remainder[shift + b_l - 1]) / divisorMostSignificantDigit);\n      } // quotientDigit <= base - 1\n\n\n      carry = 0;\n      borrow = 0;\n      l = divisor.length;\n\n      for (i = 0; i < l; i++) {\n        carry += quotientDigit * divisor[i];\n        q = Math.floor(carry / base);\n        borrow += remainder[shift + i] - (carry - q * base);\n        carry = q;\n\n        if (borrow < 0) {\n          remainder[shift + i] = borrow + base;\n          borrow = -1;\n        } else {\n          remainder[shift + i] = borrow;\n          borrow = 0;\n        }\n      }\n\n      while (borrow !== 0) {\n        quotientDigit -= 1;\n        carry = 0;\n\n        for (i = 0; i < l; i++) {\n          carry += remainder[shift + i] - base + divisor[i];\n\n          if (carry < 0) {\n            remainder[shift + i] = carry + base;\n            carry = 0;\n          } else {\n            remainder[shift + i] = carry;\n            carry = 1;\n          }\n        }\n\n        borrow += carry;\n      }\n\n      result[shift] = quotientDigit;\n    } // denormalization\n\n\n    remainder = divModSmall(remainder, lambda)[0];\n    return [arrayToSmall(result), arrayToSmall(remainder)];\n  }\n\n  function divMod2(a, b) {\n    // Implementation idea shamelessly stolen from Silent Matt's library http://silentmatt.com/biginteger/\n    // Performs faster than divMod1 on larger input sizes.\n    var a_l = a.length,\n        b_l = b.length,\n        result = [],\n        part = [],\n        base = BASE,\n        guess,\n        xlen,\n        highx,\n        highy,\n        check;\n\n    while (a_l) {\n      part.unshift(a[--a_l]);\n      trim(part);\n\n      if (compareAbs(part, b) < 0) {\n        result.push(0);\n        continue;\n      }\n\n      xlen = part.length;\n      highx = part[xlen - 1] * base + part[xlen - 2];\n      highy = b[b_l - 1] * base + b[b_l - 2];\n\n      if (xlen > b_l) {\n        highx = (highx + 1) * base;\n      }\n\n      guess = Math.ceil(highx / highy);\n\n      do {\n        check = multiplySmall(b, guess);\n        if (compareAbs(check, part) <= 0) break;\n        guess--;\n      } while (guess);\n\n      result.push(guess);\n      part = subtract(part, check);\n    }\n\n    result.reverse();\n    return [arrayToSmall(result), arrayToSmall(part)];\n  }\n\n  function divModSmall(value, lambda) {\n    var length = value.length,\n        quotient = createArray(length),\n        base = BASE,\n        i,\n        q,\n        remainder,\n        divisor;\n    remainder = 0;\n\n    for (i = length - 1; i >= 0; --i) {\n      divisor = remainder * base + value[i];\n      q = truncate(divisor / lambda);\n      remainder = divisor - q * lambda;\n      quotient[i] = q | 0;\n    }\n\n    return [quotient, remainder | 0];\n  }\n\n  function divModAny(self, v) {\n    var value,\n        n = parseValue(v);\n\n    if (supportsNativeBigInt) {\n      return [new NativeBigInt(self.value / n.value), new NativeBigInt(self.value % n.value)];\n    }\n\n    var a = self.value,\n        b = n.value;\n    var quotient;\n    if (b === 0) throw new Error(\"Cannot divide by zero\");\n\n    if (self.isSmall) {\n      if (n.isSmall) {\n        return [new SmallInteger(truncate(a / b)), new SmallInteger(a % b)];\n      }\n\n      return [Integer[0], self];\n    }\n\n    if (n.isSmall) {\n      if (b === 1) return [self, Integer[0]];\n      if (b == -1) return [self.negate(), Integer[0]];\n      var abs = Math.abs(b);\n\n      if (abs < BASE) {\n        value = divModSmall(a, abs);\n        quotient = arrayToSmall(value[0]);\n        var remainder = value[1];\n        if (self.sign) remainder = -remainder;\n\n        if (typeof quotient === \"number\") {\n          if (self.sign !== n.sign) quotient = -quotient;\n          return [new SmallInteger(quotient), new SmallInteger(remainder)];\n        }\n\n        return [new BigInteger(quotient, self.sign !== n.sign), new SmallInteger(remainder)];\n      }\n\n      b = smallToArray(abs);\n    }\n\n    var comparison = compareAbs(a, b);\n    if (comparison === -1) return [Integer[0], self];\n    if (comparison === 0) return [Integer[self.sign === n.sign ? 1 : -1], Integer[0]]; // divMod1 is faster on smaller input sizes\n\n    if (a.length + b.length <= 200) value = divMod1(a, b);else value = divMod2(a, b);\n    quotient = value[0];\n    var qSign = self.sign !== n.sign,\n        mod = value[1],\n        mSign = self.sign;\n\n    if (typeof quotient === \"number\") {\n      if (qSign) quotient = -quotient;\n      quotient = new SmallInteger(quotient);\n    } else quotient = new BigInteger(quotient, qSign);\n\n    if (typeof mod === \"number\") {\n      if (mSign) mod = -mod;\n      mod = new SmallInteger(mod);\n    } else mod = new BigInteger(mod, mSign);\n\n    return [quotient, mod];\n  }\n\n  BigInteger.prototype.divmod = function (v) {\n    var result = divModAny(this, v);\n    return {\n      quotient: result[0],\n      remainder: result[1]\n    };\n  };\n\n  NativeBigInt.prototype.divmod = SmallInteger.prototype.divmod = BigInteger.prototype.divmod;\n\n  BigInteger.prototype.divide = function (v) {\n    return divModAny(this, v)[0];\n  };\n\n  NativeBigInt.prototype.over = NativeBigInt.prototype.divide = function (v) {\n    return new NativeBigInt(this.value / parseValue(v).value);\n  };\n\n  SmallInteger.prototype.over = SmallInteger.prototype.divide = BigInteger.prototype.over = BigInteger.prototype.divide;\n\n  BigInteger.prototype.mod = function (v) {\n    return divModAny(this, v)[1];\n  };\n\n  NativeBigInt.prototype.mod = NativeBigInt.prototype.remainder = function (v) {\n    return new NativeBigInt(this.value % parseValue(v).value);\n  };\n\n  SmallInteger.prototype.remainder = SmallInteger.prototype.mod = BigInteger.prototype.remainder = BigInteger.prototype.mod;\n\n  BigInteger.prototype.pow = function (v) {\n    var n = parseValue(v),\n        a = this.value,\n        b = n.value,\n        value,\n        x,\n        y;\n    if (b === 0) return Integer[1];\n    if (a === 0) return Integer[0];\n    if (a === 1) return Integer[1];\n    if (a === -1) return n.isEven() ? Integer[1] : Integer[-1];\n\n    if (n.sign) {\n      return Integer[0];\n    }\n\n    if (!n.isSmall) throw new Error(\"The exponent \" + n.toString() + \" is too large.\");\n\n    if (this.isSmall) {\n      if (isPrecise(value = Math.pow(a, b))) return new SmallInteger(truncate(value));\n    }\n\n    x = this;\n    y = Integer[1];\n\n    while (true) {\n      if (b & 1 === 1) {\n        y = y.times(x);\n        --b;\n      }\n\n      if (b === 0) break;\n      b /= 2;\n      x = x.square();\n    }\n\n    return y;\n  };\n\n  SmallInteger.prototype.pow = BigInteger.prototype.pow;\n\n  NativeBigInt.prototype.pow = function (v) {\n    var n = parseValue(v);\n    var a = this.value,\n        b = n.value;\n\n    var _0 = BigInt(0),\n        _1 = BigInt(1),\n        _2 = BigInt(2);\n\n    if (b === _0) return Integer[1];\n    if (a === _0) return Integer[0];\n    if (a === _1) return Integer[1];\n    if (a === BigInt(-1)) return n.isEven() ? Integer[1] : Integer[-1];\n    if (n.isNegative()) return new NativeBigInt(_0);\n    var x = this;\n    var y = Integer[1];\n\n    while (true) {\n      if ((b & _1) === _1) {\n        y = y.times(x);\n        --b;\n      }\n\n      if (b === _0) break;\n      b /= _2;\n      x = x.square();\n    }\n\n    return y;\n  };\n\n  BigInteger.prototype.modPow = function (exp, mod) {\n    exp = parseValue(exp);\n    mod = parseValue(mod);\n    if (mod.isZero()) throw new Error(\"Cannot take modPow with modulus 0\");\n    var r = Integer[1],\n        base = this.mod(mod);\n\n    if (exp.isNegative()) {\n      exp = exp.multiply(Integer[-1]);\n      base = base.modInv(mod);\n    }\n\n    while (exp.isPositive()) {\n      if (base.isZero()) return Integer[0];\n      if (exp.isOdd()) r = r.multiply(base).mod(mod);\n      exp = exp.divide(2);\n      base = base.square().mod(mod);\n    }\n\n    return r;\n  };\n\n  NativeBigInt.prototype.modPow = SmallInteger.prototype.modPow = BigInteger.prototype.modPow;\n\n  function compareAbs(a, b) {\n    if (a.length !== b.length) {\n      return a.length > b.length ? 1 : -1;\n    }\n\n    for (var i = a.length - 1; i >= 0; i--) {\n      if (a[i] !== b[i]) return a[i] > b[i] ? 1 : -1;\n    }\n\n    return 0;\n  }\n\n  BigInteger.prototype.compareAbs = function (v) {\n    var n = parseValue(v),\n        a = this.value,\n        b = n.value;\n    if (n.isSmall) return 1;\n    return compareAbs(a, b);\n  };\n\n  SmallInteger.prototype.compareAbs = function (v) {\n    var n = parseValue(v),\n        a = Math.abs(this.value),\n        b = n.value;\n\n    if (n.isSmall) {\n      b = Math.abs(b);\n      return a === b ? 0 : a > b ? 1 : -1;\n    }\n\n    return -1;\n  };\n\n  NativeBigInt.prototype.compareAbs = function (v) {\n    var a = this.value;\n    var b = parseValue(v).value;\n    a = a >= 0 ? a : -a;\n    b = b >= 0 ? b : -b;\n    return a === b ? 0 : a > b ? 1 : -1;\n  };\n\n  BigInteger.prototype.compare = function (v) {\n    // See discussion about comparison with Infinity:\n    // https://github.com/peterolson/BigInteger.js/issues/61\n    if (v === Infinity) {\n      return -1;\n    }\n\n    if (v === -Infinity) {\n      return 1;\n    }\n\n    var n = parseValue(v),\n        a = this.value,\n        b = n.value;\n\n    if (this.sign !== n.sign) {\n      return n.sign ? 1 : -1;\n    }\n\n    if (n.isSmall) {\n      return this.sign ? -1 : 1;\n    }\n\n    return compareAbs(a, b) * (this.sign ? -1 : 1);\n  };\n\n  BigInteger.prototype.compareTo = BigInteger.prototype.compare;\n\n  SmallInteger.prototype.compare = function (v) {\n    if (v === Infinity) {\n      return -1;\n    }\n\n    if (v === -Infinity) {\n      return 1;\n    }\n\n    var n = parseValue(v),\n        a = this.value,\n        b = n.value;\n\n    if (n.isSmall) {\n      return a == b ? 0 : a > b ? 1 : -1;\n    }\n\n    if (a < 0 !== n.sign) {\n      return a < 0 ? -1 : 1;\n    }\n\n    return a < 0 ? 1 : -1;\n  };\n\n  SmallInteger.prototype.compareTo = SmallInteger.prototype.compare;\n\n  NativeBigInt.prototype.compare = function (v) {\n    if (v === Infinity) {\n      return -1;\n    }\n\n    if (v === -Infinity) {\n      return 1;\n    }\n\n    var a = this.value;\n    var b = parseValue(v).value;\n    return a === b ? 0 : a > b ? 1 : -1;\n  };\n\n  NativeBigInt.prototype.compareTo = NativeBigInt.prototype.compare;\n\n  BigInteger.prototype.equals = function (v) {\n    return this.compare(v) === 0;\n  };\n\n  NativeBigInt.prototype.eq = NativeBigInt.prototype.equals = SmallInteger.prototype.eq = SmallInteger.prototype.equals = BigInteger.prototype.eq = BigInteger.prototype.equals;\n\n  BigInteger.prototype.notEquals = function (v) {\n    return this.compare(v) !== 0;\n  };\n\n  NativeBigInt.prototype.neq = NativeBigInt.prototype.notEquals = SmallInteger.prototype.neq = SmallInteger.prototype.notEquals = BigInteger.prototype.neq = BigInteger.prototype.notEquals;\n\n  BigInteger.prototype.greater = function (v) {\n    return this.compare(v) > 0;\n  };\n\n  NativeBigInt.prototype.gt = NativeBigInt.prototype.greater = SmallInteger.prototype.gt = SmallInteger.prototype.greater = BigInteger.prototype.gt = BigInteger.prototype.greater;\n\n  BigInteger.prototype.lesser = function (v) {\n    return this.compare(v) < 0;\n  };\n\n  NativeBigInt.prototype.lt = NativeBigInt.prototype.lesser = SmallInteger.prototype.lt = SmallInteger.prototype.lesser = BigInteger.prototype.lt = BigInteger.prototype.lesser;\n\n  BigInteger.prototype.greaterOrEquals = function (v) {\n    return this.compare(v) >= 0;\n  };\n\n  NativeBigInt.prototype.geq = NativeBigInt.prototype.greaterOrEquals = SmallInteger.prototype.geq = SmallInteger.prototype.greaterOrEquals = BigInteger.prototype.geq = BigInteger.prototype.greaterOrEquals;\n\n  BigInteger.prototype.lesserOrEquals = function (v) {\n    return this.compare(v) <= 0;\n  };\n\n  NativeBigInt.prototype.leq = NativeBigInt.prototype.lesserOrEquals = SmallInteger.prototype.leq = SmallInteger.prototype.lesserOrEquals = BigInteger.prototype.leq = BigInteger.prototype.lesserOrEquals;\n\n  BigInteger.prototype.isEven = function () {\n    return (this.value[0] & 1) === 0;\n  };\n\n  SmallInteger.prototype.isEven = function () {\n    return (this.value & 1) === 0;\n  };\n\n  NativeBigInt.prototype.isEven = function () {\n    return (this.value & BigInt(1)) === BigInt(0);\n  };\n\n  BigInteger.prototype.isOdd = function () {\n    return (this.value[0] & 1) === 1;\n  };\n\n  SmallInteger.prototype.isOdd = function () {\n    return (this.value & 1) === 1;\n  };\n\n  NativeBigInt.prototype.isOdd = function () {\n    return (this.value & BigInt(1)) === BigInt(1);\n  };\n\n  BigInteger.prototype.isPositive = function () {\n    return !this.sign;\n  };\n\n  SmallInteger.prototype.isPositive = function () {\n    return this.value > 0;\n  };\n\n  NativeBigInt.prototype.isPositive = SmallInteger.prototype.isPositive;\n\n  BigInteger.prototype.isNegative = function () {\n    return this.sign;\n  };\n\n  SmallInteger.prototype.isNegative = function () {\n    return this.value < 0;\n  };\n\n  NativeBigInt.prototype.isNegative = SmallInteger.prototype.isNegative;\n\n  BigInteger.prototype.isUnit = function () {\n    return false;\n  };\n\n  SmallInteger.prototype.isUnit = function () {\n    return Math.abs(this.value) === 1;\n  };\n\n  NativeBigInt.prototype.isUnit = function () {\n    return this.abs().value === BigInt(1);\n  };\n\n  BigInteger.prototype.isZero = function () {\n    return false;\n  };\n\n  SmallInteger.prototype.isZero = function () {\n    return this.value === 0;\n  };\n\n  NativeBigInt.prototype.isZero = function () {\n    return this.value === BigInt(0);\n  };\n\n  BigInteger.prototype.isDivisibleBy = function (v) {\n    var n = parseValue(v);\n    if (n.isZero()) return false;\n    if (n.isUnit()) return true;\n    if (n.compareAbs(2) === 0) return this.isEven();\n    return this.mod(n).isZero();\n  };\n\n  NativeBigInt.prototype.isDivisibleBy = SmallInteger.prototype.isDivisibleBy = BigInteger.prototype.isDivisibleBy;\n\n  function isBasicPrime(v) {\n    var n = v.abs();\n    if (n.isUnit()) return false;\n    if (n.equals(2) || n.equals(3) || n.equals(5)) return true;\n    if (n.isEven() || n.isDivisibleBy(3) || n.isDivisibleBy(5)) return false;\n    if (n.lesser(49)) return true; // we don't know if it's prime: let the other functions figure it out\n  }\n\n  function millerRabinTest(n, a) {\n    var nPrev = n.prev(),\n        b = nPrev,\n        r = 0,\n        d,\n        t,\n        i,\n        x;\n\n    while (b.isEven()) b = b.divide(2), r++;\n\n    next: for (i = 0; i < a.length; i++) {\n      if (n.lesser(a[i])) continue;\n      x = bigInt(a[i]).modPow(b, n);\n      if (x.isUnit() || x.equals(nPrev)) continue;\n\n      for (d = r - 1; d != 0; d--) {\n        x = x.square().mod(n);\n        if (x.isUnit()) return false;\n        if (x.equals(nPrev)) continue next;\n      }\n\n      return false;\n    }\n\n    return true;\n  } // Set \"strict\" to true to force GRH-supported lower bound of 2*log(N)^2\n\n\n  BigInteger.prototype.isPrime = function (strict) {\n    var isPrime = isBasicPrime(this);\n    if (isPrime !== undefined) return isPrime;\n    var n = this.abs();\n    var bits = n.bitLength();\n    if (bits <= 64) return millerRabinTest(n, [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37]);\n    var logN = Math.log(2) * bits.toJSNumber();\n    var t = Math.ceil(strict === true ? 2 * Math.pow(logN, 2) : logN);\n\n    for (var a = [], i = 0; i < t; i++) {\n      a.push(bigInt(i + 2));\n    }\n\n    return millerRabinTest(n, a);\n  };\n\n  NativeBigInt.prototype.isPrime = SmallInteger.prototype.isPrime = BigInteger.prototype.isPrime;\n\n  BigInteger.prototype.isProbablePrime = function (iterations, rng) {\n    var isPrime = isBasicPrime(this);\n    if (isPrime !== undefined) return isPrime;\n    var n = this.abs();\n    var t = iterations === undefined ? 5 : iterations;\n\n    for (var a = [], i = 0; i < t; i++) {\n      a.push(bigInt.randBetween(2, n.minus(2), rng));\n    }\n\n    return millerRabinTest(n, a);\n  };\n\n  NativeBigInt.prototype.isProbablePrime = SmallInteger.prototype.isProbablePrime = BigInteger.prototype.isProbablePrime;\n\n  BigInteger.prototype.modInv = function (n) {\n    var t = bigInt.zero,\n        newT = bigInt.one,\n        r = parseValue(n),\n        newR = this.abs(),\n        q,\n        lastT,\n        lastR;\n\n    while (!newR.isZero()) {\n      q = r.divide(newR);\n      lastT = t;\n      lastR = r;\n      t = newT;\n      r = newR;\n      newT = lastT.subtract(q.multiply(newT));\n      newR = lastR.subtract(q.multiply(newR));\n    }\n\n    if (!r.isUnit()) throw new Error(this.toString() + \" and \" + n.toString() + \" are not co-prime\");\n\n    if (t.compare(0) === -1) {\n      t = t.add(n);\n    }\n\n    if (this.isNegative()) {\n      return t.negate();\n    }\n\n    return t;\n  };\n\n  NativeBigInt.prototype.modInv = SmallInteger.prototype.modInv = BigInteger.prototype.modInv;\n\n  BigInteger.prototype.next = function () {\n    var value = this.value;\n\n    if (this.sign) {\n      return subtractSmall(value, 1, this.sign);\n    }\n\n    return new BigInteger(addSmall(value, 1), this.sign);\n  };\n\n  SmallInteger.prototype.next = function () {\n    var value = this.value;\n    if (value + 1 < MAX_INT) return new SmallInteger(value + 1);\n    return new BigInteger(MAX_INT_ARR, false);\n  };\n\n  NativeBigInt.prototype.next = function () {\n    return new NativeBigInt(this.value + BigInt(1));\n  };\n\n  BigInteger.prototype.prev = function () {\n    var value = this.value;\n\n    if (this.sign) {\n      return new BigInteger(addSmall(value, 1), true);\n    }\n\n    return subtractSmall(value, 1, this.sign);\n  };\n\n  SmallInteger.prototype.prev = function () {\n    var value = this.value;\n    if (value - 1 > -MAX_INT) return new SmallInteger(value - 1);\n    return new BigInteger(MAX_INT_ARR, true);\n  };\n\n  NativeBigInt.prototype.prev = function () {\n    return new NativeBigInt(this.value - BigInt(1));\n  };\n\n  var powersOfTwo = [1];\n\n  while (2 * powersOfTwo[powersOfTwo.length - 1] <= BASE) powersOfTwo.push(2 * powersOfTwo[powersOfTwo.length - 1]);\n\n  var powers2Length = powersOfTwo.length,\n      highestPower2 = powersOfTwo[powers2Length - 1];\n\n  function shift_isSmall(n) {\n    return Math.abs(n) <= BASE;\n  }\n\n  BigInteger.prototype.shiftLeft = function (v) {\n    var n = parseValue(v).toJSNumber();\n\n    if (!shift_isSmall(n)) {\n      throw new Error(String(n) + \" is too large for shifting.\");\n    }\n\n    if (n < 0) return this.shiftRight(-n);\n    var result = this;\n    if (result.isZero()) return result;\n\n    while (n >= powers2Length) {\n      result = result.multiply(highestPower2);\n      n -= powers2Length - 1;\n    }\n\n    return result.multiply(powersOfTwo[n]);\n  };\n\n  NativeBigInt.prototype.shiftLeft = SmallInteger.prototype.shiftLeft = BigInteger.prototype.shiftLeft;\n\n  BigInteger.prototype.shiftRight = function (v) {\n    var remQuo;\n    var n = parseValue(v).toJSNumber();\n\n    if (!shift_isSmall(n)) {\n      throw new Error(String(n) + \" is too large for shifting.\");\n    }\n\n    if (n < 0) return this.shiftLeft(-n);\n    var result = this;\n\n    while (n >= powers2Length) {\n      if (result.isZero() || result.isNegative() && result.isUnit()) return result;\n      remQuo = divModAny(result, highestPower2);\n      result = remQuo[1].isNegative() ? remQuo[0].prev() : remQuo[0];\n      n -= powers2Length - 1;\n    }\n\n    remQuo = divModAny(result, powersOfTwo[n]);\n    return remQuo[1].isNegative() ? remQuo[0].prev() : remQuo[0];\n  };\n\n  NativeBigInt.prototype.shiftRight = SmallInteger.prototype.shiftRight = BigInteger.prototype.shiftRight;\n\n  function bitwise(x, y, fn) {\n    y = parseValue(y);\n    var xSign = x.isNegative(),\n        ySign = y.isNegative();\n    var xRem = xSign ? x.not() : x,\n        yRem = ySign ? y.not() : y;\n    var xDigit = 0,\n        yDigit = 0;\n    var xDivMod = null,\n        yDivMod = null;\n    var result = [];\n\n    while (!xRem.isZero() || !yRem.isZero()) {\n      xDivMod = divModAny(xRem, highestPower2);\n      xDigit = xDivMod[1].toJSNumber();\n\n      if (xSign) {\n        xDigit = highestPower2 - 1 - xDigit; // two's complement for negative numbers\n      }\n\n      yDivMod = divModAny(yRem, highestPower2);\n      yDigit = yDivMod[1].toJSNumber();\n\n      if (ySign) {\n        yDigit = highestPower2 - 1 - yDigit; // two's complement for negative numbers\n      }\n\n      xRem = xDivMod[0];\n      yRem = yDivMod[0];\n      result.push(fn(xDigit, yDigit));\n    }\n\n    var sum = fn(xSign ? 1 : 0, ySign ? 1 : 0) !== 0 ? bigInt(-1) : bigInt(0);\n\n    for (var i = result.length - 1; i >= 0; i -= 1) {\n      sum = sum.multiply(highestPower2).add(bigInt(result[i]));\n    }\n\n    return sum;\n  }\n\n  BigInteger.prototype.not = function () {\n    return this.negate().prev();\n  };\n\n  NativeBigInt.prototype.not = SmallInteger.prototype.not = BigInteger.prototype.not;\n\n  BigInteger.prototype.and = function (n) {\n    return bitwise(this, n, function (a, b) {\n      return a & b;\n    });\n  };\n\n  NativeBigInt.prototype.and = SmallInteger.prototype.and = BigInteger.prototype.and;\n\n  BigInteger.prototype.or = function (n) {\n    return bitwise(this, n, function (a, b) {\n      return a | b;\n    });\n  };\n\n  NativeBigInt.prototype.or = SmallInteger.prototype.or = BigInteger.prototype.or;\n\n  BigInteger.prototype.xor = function (n) {\n    return bitwise(this, n, function (a, b) {\n      return a ^ b;\n    });\n  };\n\n  NativeBigInt.prototype.xor = SmallInteger.prototype.xor = BigInteger.prototype.xor;\n  var LOBMASK_I = 1 << 30,\n      LOBMASK_BI = (BASE & -BASE) * (BASE & -BASE) | LOBMASK_I;\n\n  function roughLOB(n) {\n    // get lowestOneBit (rough)\n    // SmallInteger: return Min(lowestOneBit(n), 1 << 30)\n    // BigInteger: return Min(lowestOneBit(n), 1 << 14) [BASE=1e7]\n    var v = n.value,\n        x = typeof v === \"number\" ? v | LOBMASK_I : typeof v === \"bigint\" ? v | BigInt(LOBMASK_I) : v[0] + v[1] * BASE | LOBMASK_BI;\n    return x & -x;\n  }\n\n  function integerLogarithm(value, base) {\n    if (base.compareTo(value) <= 0) {\n      var tmp = integerLogarithm(value, base.square(base));\n      var p = tmp.p;\n      var e = tmp.e;\n      var t = p.multiply(base);\n      return t.compareTo(value) <= 0 ? {\n        p: t,\n        e: e * 2 + 1\n      } : {\n        p: p,\n        e: e * 2\n      };\n    }\n\n    return {\n      p: bigInt(1),\n      e: 0\n    };\n  }\n\n  BigInteger.prototype.bitLength = function () {\n    var n = this;\n\n    if (n.compareTo(bigInt(0)) < 0) {\n      n = n.negate().subtract(bigInt(1));\n    }\n\n    if (n.compareTo(bigInt(0)) === 0) {\n      return bigInt(0);\n    }\n\n    return bigInt(integerLogarithm(n, bigInt(2)).e).add(bigInt(1));\n  };\n\n  NativeBigInt.prototype.bitLength = SmallInteger.prototype.bitLength = BigInteger.prototype.bitLength;\n\n  function max(a, b) {\n    a = parseValue(a);\n    b = parseValue(b);\n    return a.greater(b) ? a : b;\n  }\n\n  function min(a, b) {\n    a = parseValue(a);\n    b = parseValue(b);\n    return a.lesser(b) ? a : b;\n  }\n\n  function gcd(a, b) {\n    a = parseValue(a).abs();\n    b = parseValue(b).abs();\n    if (a.equals(b)) return a;\n    if (a.isZero()) return b;\n    if (b.isZero()) return a;\n    var c = Integer[1],\n        d,\n        t;\n\n    while (a.isEven() && b.isEven()) {\n      d = min(roughLOB(a), roughLOB(b));\n      a = a.divide(d);\n      b = b.divide(d);\n      c = c.multiply(d);\n    }\n\n    while (a.isEven()) {\n      a = a.divide(roughLOB(a));\n    }\n\n    do {\n      while (b.isEven()) {\n        b = b.divide(roughLOB(b));\n      }\n\n      if (a.greater(b)) {\n        t = b;\n        b = a;\n        a = t;\n      }\n\n      b = b.subtract(a);\n    } while (!b.isZero());\n\n    return c.isUnit() ? a : a.multiply(c);\n  }\n\n  function lcm(a, b) {\n    a = parseValue(a).abs();\n    b = parseValue(b).abs();\n    return a.divide(gcd(a, b)).multiply(b);\n  }\n\n  function randBetween(a, b, rng) {\n    a = parseValue(a);\n    b = parseValue(b);\n    var usedRNG = rng || Math.random;\n    var low = min(a, b),\n        high = max(a, b);\n    var range = high.subtract(low).add(1);\n    if (range.isSmall) return low.add(Math.floor(usedRNG() * range));\n    var digits = toBase(range, BASE).value;\n    var result = [],\n        restricted = true;\n\n    for (var i = 0; i < digits.length; i++) {\n      var top = restricted ? digits[i] : BASE;\n      var digit = truncate(usedRNG() * top);\n      result.push(digit);\n      if (digit < top) restricted = false;\n    }\n\n    return low.add(Integer.fromArray(result, BASE, false));\n  }\n\n  var parseBase = function (text, base, alphabet, caseSensitive) {\n    alphabet = alphabet || DEFAULT_ALPHABET;\n    text = String(text);\n\n    if (!caseSensitive) {\n      text = text.toLowerCase();\n      alphabet = alphabet.toLowerCase();\n    }\n\n    var length = text.length;\n    var i;\n    var absBase = Math.abs(base);\n    var alphabetValues = {};\n\n    for (i = 0; i < alphabet.length; i++) {\n      alphabetValues[alphabet[i]] = i;\n    }\n\n    for (i = 0; i < length; i++) {\n      var c = text[i];\n      if (c === \"-\") continue;\n\n      if (c in alphabetValues) {\n        if (alphabetValues[c] >= absBase) {\n          if (c === \"1\" && absBase === 1) continue;\n          throw new Error(c + \" is not a valid digit in base \" + base + \".\");\n        }\n      }\n    }\n\n    base = parseValue(base);\n    var digits = [];\n    var isNegative = text[0] === \"-\";\n\n    for (i = isNegative ? 1 : 0; i < text.length; i++) {\n      var c = text[i];\n      if (c in alphabetValues) digits.push(parseValue(alphabetValues[c]));else if (c === \"<\") {\n        var start = i;\n\n        do {\n          i++;\n        } while (text[i] !== \">\" && i < text.length);\n\n        digits.push(parseValue(text.slice(start + 1, i)));\n      } else throw new Error(c + \" is not a valid character\");\n    }\n\n    return parseBaseFromArray(digits, base, isNegative);\n  };\n\n  function parseBaseFromArray(digits, base, isNegative) {\n    var val = Integer[0],\n        pow = Integer[1],\n        i;\n\n    for (i = digits.length - 1; i >= 0; i--) {\n      val = val.add(digits[i].times(pow));\n      pow = pow.times(base);\n    }\n\n    return isNegative ? val.negate() : val;\n  }\n\n  function stringify(digit, alphabet) {\n    alphabet = alphabet || DEFAULT_ALPHABET;\n\n    if (digit < alphabet.length) {\n      return alphabet[digit];\n    }\n\n    return \"<\" + digit + \">\";\n  }\n\n  function toBase(n, base) {\n    base = bigInt(base);\n\n    if (base.isZero()) {\n      if (n.isZero()) return {\n        value: [0],\n        isNegative: false\n      };\n      throw new Error(\"Cannot convert nonzero numbers to base 0.\");\n    }\n\n    if (base.equals(-1)) {\n      if (n.isZero()) return {\n        value: [0],\n        isNegative: false\n      };\n      if (n.isNegative()) return {\n        value: [].concat.apply([], Array.apply(null, Array(-n.toJSNumber())).map(Array.prototype.valueOf, [1, 0])),\n        isNegative: false\n      };\n      var arr = Array.apply(null, Array(n.toJSNumber() - 1)).map(Array.prototype.valueOf, [0, 1]);\n      arr.unshift([1]);\n      return {\n        value: [].concat.apply([], arr),\n        isNegative: false\n      };\n    }\n\n    var neg = false;\n\n    if (n.isNegative() && base.isPositive()) {\n      neg = true;\n      n = n.abs();\n    }\n\n    if (base.isUnit()) {\n      if (n.isZero()) return {\n        value: [0],\n        isNegative: false\n      };\n      return {\n        value: Array.apply(null, Array(n.toJSNumber())).map(Number.prototype.valueOf, 1),\n        isNegative: neg\n      };\n    }\n\n    var out = [];\n    var left = n,\n        divmod;\n\n    while (left.isNegative() || left.compareAbs(base) >= 0) {\n      divmod = left.divmod(base);\n      left = divmod.quotient;\n      var digit = divmod.remainder;\n\n      if (digit.isNegative()) {\n        digit = base.minus(digit).abs();\n        left = left.next();\n      }\n\n      out.push(digit.toJSNumber());\n    }\n\n    out.push(left.toJSNumber());\n    return {\n      value: out.reverse(),\n      isNegative: neg\n    };\n  }\n\n  function toBaseString(n, base, alphabet) {\n    var arr = toBase(n, base);\n    return (arr.isNegative ? \"-\" : \"\") + arr.value.map(function (x) {\n      return stringify(x, alphabet);\n    }).join('');\n  }\n\n  BigInteger.prototype.toArray = function (radix) {\n    return toBase(this, radix);\n  };\n\n  SmallInteger.prototype.toArray = function (radix) {\n    return toBase(this, radix);\n  };\n\n  NativeBigInt.prototype.toArray = function (radix) {\n    return toBase(this, radix);\n  };\n\n  BigInteger.prototype.toString = function (radix, alphabet) {\n    if (radix === undefined) radix = 10;\n    if (radix !== 10) return toBaseString(this, radix, alphabet);\n    var v = this.value,\n        l = v.length,\n        str = String(v[--l]),\n        zeros = \"0000000\",\n        digit;\n\n    while (--l >= 0) {\n      digit = String(v[l]);\n      str += zeros.slice(digit.length) + digit;\n    }\n\n    var sign = this.sign ? \"-\" : \"\";\n    return sign + str;\n  };\n\n  SmallInteger.prototype.toString = function (radix, alphabet) {\n    if (radix === undefined) radix = 10;\n    if (radix != 10) return toBaseString(this, radix, alphabet);\n    return String(this.value);\n  };\n\n  NativeBigInt.prototype.toString = SmallInteger.prototype.toString;\n\n  NativeBigInt.prototype.toJSON = BigInteger.prototype.toJSON = SmallInteger.prototype.toJSON = function () {\n    return this.toString();\n  };\n\n  BigInteger.prototype.valueOf = function () {\n    return parseInt(this.toString(), 10);\n  };\n\n  BigInteger.prototype.toJSNumber = BigInteger.prototype.valueOf;\n\n  SmallInteger.prototype.valueOf = function () {\n    return this.value;\n  };\n\n  SmallInteger.prototype.toJSNumber = SmallInteger.prototype.valueOf;\n\n  NativeBigInt.prototype.valueOf = NativeBigInt.prototype.toJSNumber = function () {\n    return parseInt(this.toString(), 10);\n  };\n\n  function parseStringValue(v) {\n    if (isPrecise(+v)) {\n      var x = +v;\n      if (x === truncate(x)) return supportsNativeBigInt ? new NativeBigInt(BigInt(x)) : new SmallInteger(x);\n      throw new Error(\"Invalid integer: \" + v);\n    }\n\n    var sign = v[0] === \"-\";\n    if (sign) v = v.slice(1);\n    var split = v.split(/e/i);\n    if (split.length > 2) throw new Error(\"Invalid integer: \" + split.join(\"e\"));\n\n    if (split.length === 2) {\n      var exp = split[1];\n      if (exp[0] === \"+\") exp = exp.slice(1);\n      exp = +exp;\n      if (exp !== truncate(exp) || !isPrecise(exp)) throw new Error(\"Invalid integer: \" + exp + \" is not a valid exponent.\");\n      var text = split[0];\n      var decimalPlace = text.indexOf(\".\");\n\n      if (decimalPlace >= 0) {\n        exp -= text.length - decimalPlace - 1;\n        text = text.slice(0, decimalPlace) + text.slice(decimalPlace + 1);\n      }\n\n      if (exp < 0) throw new Error(\"Cannot include negative exponent part for integers\");\n      text += new Array(exp + 1).join(\"0\");\n      v = text;\n    }\n\n    var isValid = /^([0-9][0-9]*)$/.test(v);\n    if (!isValid) throw new Error(\"Invalid integer: \" + v);\n\n    if (supportsNativeBigInt) {\n      return new NativeBigInt(BigInt(sign ? \"-\" + v : v));\n    }\n\n    var r = [],\n        max = v.length,\n        l = LOG_BASE,\n        min = max - l;\n\n    while (max > 0) {\n      r.push(+v.slice(min, max));\n      min -= l;\n      if (min < 0) min = 0;\n      max -= l;\n    }\n\n    trim(r);\n    return new BigInteger(r, sign);\n  }\n\n  function parseNumberValue(v) {\n    if (supportsNativeBigInt) {\n      return new NativeBigInt(BigInt(v));\n    }\n\n    if (isPrecise(v)) {\n      if (v !== truncate(v)) throw new Error(v + \" is not an integer.\");\n      return new SmallInteger(v);\n    }\n\n    return parseStringValue(v.toString());\n  }\n\n  function parseValue(v) {\n    if (typeof v === \"number\") {\n      return parseNumberValue(v);\n    }\n\n    if (typeof v === \"string\") {\n      return parseStringValue(v);\n    }\n\n    if (typeof v === \"bigint\") {\n      return new NativeBigInt(v);\n    }\n\n    return v;\n  } // Pre-define numbers in range [-999,999]\n\n\n  for (var i = 0; i < 1000; i++) {\n    Integer[i] = parseValue(i);\n    if (i > 0) Integer[-i] = parseValue(-i);\n  } // Backwards compatibility\n\n\n  Integer.one = Integer[1];\n  Integer.zero = Integer[0];\n  Integer.minusOne = Integer[-1];\n  Integer.max = max;\n  Integer.min = min;\n  Integer.gcd = gcd;\n  Integer.lcm = lcm;\n\n  Integer.isInstance = function (x) {\n    return x instanceof BigInteger || x instanceof SmallInteger || x instanceof NativeBigInt;\n  };\n\n  Integer.randBetween = randBetween;\n\n  Integer.fromArray = function (digits, base, isNegative) {\n    return parseBaseFromArray(digits.map(parseValue), parseValue(base || 10), isNegative);\n  };\n\n  return Integer;\n}(); // Node.js check\n\n\nif (typeof module !== \"undefined\" && module.hasOwnProperty(\"exports\")) {\n  module.exports = bigInt;\n} //amd check\n\n\nif (typeof define === \"function\" && define.amd) {\n  define(function () {\n    return bigInt;\n  });\n}","map":{"version":3,"sources":["/home/madhav/P2P Lending/node_modules/big-integer/BigInteger.js"],"names":["bigInt","undefined","BASE","LOG_BASE","MAX_INT","MAX_INT_ARR","smallToArray","DEFAULT_ALPHABET","supportsNativeBigInt","BigInt","Integer","v","radix","alphabet","caseSensitive","parseValue","parseBase","BigInteger","value","sign","isSmall","prototype","Object","create","SmallInteger","NativeBigInt","isPrecise","n","Math","floor","arrayToSmall","arr","trim","length","compareAbs","i","createArray","x","Array","truncate","ceil","add","a","b","l_a","l_b","r","carry","base","sum","push","addAny","addSmall","l","subtract","negate","abs","plus","a_l","b_l","borrow","difference","subtractAny","subtractSmall","minus","small","multiplyLong","product","a_i","b_j","j","multiplySmall","shiftLeft","concat","multiplyKaratsuba","y","max","slice","d","c","ac","bd","abcd","useKaratsuba","l1","l2","multiply","times","multiplySmallAndArray","_multiplyBySmall","square","a_j","divMod1","result","divisorMostSignificantDigit","lambda","remainder","divisor","quotientDigit","shift","q","divModSmall","divMod2","part","guess","xlen","highx","highy","check","unshift","reverse","quotient","divModAny","self","Error","comparison","qSign","mod","mSign","divmod","divide","over","pow","isEven","toString","_0","_1","_2","isNegative","modPow","exp","isZero","modInv","isPositive","isOdd","compare","Infinity","compareTo","equals","eq","notEquals","neq","greater","gt","lesser","lt","greaterOrEquals","geq","lesserOrEquals","leq","isUnit","isDivisibleBy","isBasicPrime","millerRabinTest","nPrev","prev","t","next","isPrime","strict","bits","bitLength","logN","log","toJSNumber","isProbablePrime","iterations","rng","randBetween","zero","newT","one","newR","lastT","lastR","powersOfTwo","powers2Length","highestPower2","shift_isSmall","String","shiftRight","remQuo","bitwise","fn","xSign","ySign","xRem","not","yRem","xDigit","yDigit","xDivMod","yDivMod","and","or","xor","LOBMASK_I","LOBMASK_BI","roughLOB","integerLogarithm","tmp","p","e","min","gcd","lcm","usedRNG","random","low","high","range","digits","toBase","restricted","top","digit","fromArray","text","toLowerCase","absBase","alphabetValues","start","parseBaseFromArray","val","stringify","apply","map","valueOf","neg","Number","out","left","toBaseString","join","toArray","str","zeros","toJSON","parseInt","parseStringValue","split","decimalPlace","indexOf","isValid","test","parseNumberValue","minusOne","isInstance","module","hasOwnProperty","exports","define","amd"],"mappings":"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","sourcesContent":["var bigInt = (function (undefined) {\r\n    \"use strict\";\r\n\r\n    var BASE = 1e7,\r\n        LOG_BASE = 7,\r\n        MAX_INT = 9007199254740992,\r\n        MAX_INT_ARR = smallToArray(MAX_INT),\r\n        DEFAULT_ALPHABET = \"0123456789abcdefghijklmnopqrstuvwxyz\";\r\n\r\n    var supportsNativeBigInt = typeof BigInt === \"function\";\r\n\r\n    function Integer(v, radix, alphabet, caseSensitive) {\r\n        if (typeof v === \"undefined\") return Integer[0];\r\n        if (typeof radix !== \"undefined\") return +radix === 10 && !alphabet ? parseValue(v) : parseBase(v, radix, alphabet, caseSensitive);\r\n        return parseValue(v);\r\n    }\r\n\r\n    function BigInteger(value, sign) {\r\n        this.value = value;\r\n        this.sign = sign;\r\n        this.isSmall = false;\r\n    }\r\n    BigInteger.prototype = Object.create(Integer.prototype);\r\n\r\n    function SmallInteger(value) {\r\n        this.value = value;\r\n        this.sign = value < 0;\r\n        this.isSmall = true;\r\n    }\r\n    SmallInteger.prototype = Object.create(Integer.prototype);\r\n\r\n    function NativeBigInt(value) {\r\n        this.value = value;\r\n    }\r\n    NativeBigInt.prototype = Object.create(Integer.prototype);\r\n\r\n    function isPrecise(n) {\r\n        return -MAX_INT < n && n < MAX_INT;\r\n    }\r\n\r\n    function smallToArray(n) { // For performance reasons doesn't reference BASE, need to change this function if BASE changes\r\n        if (n < 1e7)\r\n            return [n];\r\n        if (n < 1e14)\r\n            return [n % 1e7, Math.floor(n / 1e7)];\r\n        return [n % 1e7, Math.floor(n / 1e7) % 1e7, Math.floor(n / 1e14)];\r\n    }\r\n\r\n    function arrayToSmall(arr) { // If BASE changes this function may need to change\r\n        trim(arr);\r\n        var length = arr.length;\r\n        if (length < 4 && compareAbs(arr, MAX_INT_ARR) < 0) {\r\n            switch (length) {\r\n                case 0: return 0;\r\n                case 1: return arr[0];\r\n                case 2: return arr[0] + arr[1] * BASE;\r\n                default: return arr[0] + (arr[1] + arr[2] * BASE) * BASE;\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n\r\n    function trim(v) {\r\n        var i = v.length;\r\n        while (v[--i] === 0);\r\n        v.length = i + 1;\r\n    }\r\n\r\n    function createArray(length) { // function shamelessly stolen from Yaffle's library https://github.com/Yaffle/BigInteger\r\n        var x = new Array(length);\r\n        var i = -1;\r\n        while (++i < length) {\r\n            x[i] = 0;\r\n        }\r\n        return x;\r\n    }\r\n\r\n    function truncate(n) {\r\n        if (n > 0) return Math.floor(n);\r\n        return Math.ceil(n);\r\n    }\r\n\r\n    function add(a, b) { // assumes a and b are arrays with a.length >= b.length\r\n        var l_a = a.length,\r\n            l_b = b.length,\r\n            r = new Array(l_a),\r\n            carry = 0,\r\n            base = BASE,\r\n            sum, i;\r\n        for (i = 0; i < l_b; i++) {\r\n            sum = a[i] + b[i] + carry;\r\n            carry = sum >= base ? 1 : 0;\r\n            r[i] = sum - carry * base;\r\n        }\r\n        while (i < l_a) {\r\n            sum = a[i] + carry;\r\n            carry = sum === base ? 1 : 0;\r\n            r[i++] = sum - carry * base;\r\n        }\r\n        if (carry > 0) r.push(carry);\r\n        return r;\r\n    }\r\n\r\n    function addAny(a, b) {\r\n        if (a.length >= b.length) return add(a, b);\r\n        return add(b, a);\r\n    }\r\n\r\n    function addSmall(a, carry) { // assumes a is array, carry is number with 0 <= carry < MAX_INT\r\n        var l = a.length,\r\n            r = new Array(l),\r\n            base = BASE,\r\n            sum, i;\r\n        for (i = 0; i < l; i++) {\r\n            sum = a[i] - base + carry;\r\n            carry = Math.floor(sum / base);\r\n            r[i] = sum - carry * base;\r\n            carry += 1;\r\n        }\r\n        while (carry > 0) {\r\n            r[i++] = carry % base;\r\n            carry = Math.floor(carry / base);\r\n        }\r\n        return r;\r\n    }\r\n\r\n    BigInteger.prototype.add = function (v) {\r\n        var n = parseValue(v);\r\n        if (this.sign !== n.sign) {\r\n            return this.subtract(n.negate());\r\n        }\r\n        var a = this.value, b = n.value;\r\n        if (n.isSmall) {\r\n            return new BigInteger(addSmall(a, Math.abs(b)), this.sign);\r\n        }\r\n        return new BigInteger(addAny(a, b), this.sign);\r\n    };\r\n    BigInteger.prototype.plus = BigInteger.prototype.add;\r\n\r\n    SmallInteger.prototype.add = function (v) {\r\n        var n = parseValue(v);\r\n        var a = this.value;\r\n        if (a < 0 !== n.sign) {\r\n            return this.subtract(n.negate());\r\n        }\r\n        var b = n.value;\r\n        if (n.isSmall) {\r\n            if (isPrecise(a + b)) return new SmallInteger(a + b);\r\n            b = smallToArray(Math.abs(b));\r\n        }\r\n        return new BigInteger(addSmall(b, Math.abs(a)), a < 0);\r\n    };\r\n    SmallInteger.prototype.plus = SmallInteger.prototype.add;\r\n\r\n    NativeBigInt.prototype.add = function (v) {\r\n        return new NativeBigInt(this.value + parseValue(v).value);\r\n    }\r\n    NativeBigInt.prototype.plus = NativeBigInt.prototype.add;\r\n\r\n    function subtract(a, b) { // assumes a and b are arrays with a >= b\r\n        var a_l = a.length,\r\n            b_l = b.length,\r\n            r = new Array(a_l),\r\n            borrow = 0,\r\n            base = BASE,\r\n            i, difference;\r\n        for (i = 0; i < b_l; i++) {\r\n            difference = a[i] - borrow - b[i];\r\n            if (difference < 0) {\r\n                difference += base;\r\n                borrow = 1;\r\n            } else borrow = 0;\r\n            r[i] = difference;\r\n        }\r\n        for (i = b_l; i < a_l; i++) {\r\n            difference = a[i] - borrow;\r\n            if (difference < 0) difference += base;\r\n            else {\r\n                r[i++] = difference;\r\n                break;\r\n            }\r\n            r[i] = difference;\r\n        }\r\n        for (; i < a_l; i++) {\r\n            r[i] = a[i];\r\n        }\r\n        trim(r);\r\n        return r;\r\n    }\r\n\r\n    function subtractAny(a, b, sign) {\r\n        var value;\r\n        if (compareAbs(a, b) >= 0) {\r\n            value = subtract(a, b);\r\n        } else {\r\n            value = subtract(b, a);\r\n            sign = !sign;\r\n        }\r\n        value = arrayToSmall(value);\r\n        if (typeof value === \"number\") {\r\n            if (sign) value = -value;\r\n            return new SmallInteger(value);\r\n        }\r\n        return new BigInteger(value, sign);\r\n    }\r\n\r\n    function subtractSmall(a, b, sign) { // assumes a is array, b is number with 0 <= b < MAX_INT\r\n        var l = a.length,\r\n            r = new Array(l),\r\n            carry = -b,\r\n            base = BASE,\r\n            i, difference;\r\n        for (i = 0; i < l; i++) {\r\n            difference = a[i] + carry;\r\n            carry = Math.floor(difference / base);\r\n            difference %= base;\r\n            r[i] = difference < 0 ? difference + base : difference;\r\n        }\r\n        r = arrayToSmall(r);\r\n        if (typeof r === \"number\") {\r\n            if (sign) r = -r;\r\n            return new SmallInteger(r);\r\n        } return new BigInteger(r, sign);\r\n    }\r\n\r\n    BigInteger.prototype.subtract = function (v) {\r\n        var n = parseValue(v);\r\n        if (this.sign !== n.sign) {\r\n            return this.add(n.negate());\r\n        }\r\n        var a = this.value, b = n.value;\r\n        if (n.isSmall)\r\n            return subtractSmall(a, Math.abs(b), this.sign);\r\n        return subtractAny(a, b, this.sign);\r\n    };\r\n    BigInteger.prototype.minus = BigInteger.prototype.subtract;\r\n\r\n    SmallInteger.prototype.subtract = function (v) {\r\n        var n = parseValue(v);\r\n        var a = this.value;\r\n        if (a < 0 !== n.sign) {\r\n            return this.add(n.negate());\r\n        }\r\n        var b = n.value;\r\n        if (n.isSmall) {\r\n            return new SmallInteger(a - b);\r\n        }\r\n        return subtractSmall(b, Math.abs(a), a >= 0);\r\n    };\r\n    SmallInteger.prototype.minus = SmallInteger.prototype.subtract;\r\n\r\n    NativeBigInt.prototype.subtract = function (v) {\r\n        return new NativeBigInt(this.value - parseValue(v).value);\r\n    }\r\n    NativeBigInt.prototype.minus = NativeBigInt.prototype.subtract;\r\n\r\n    BigInteger.prototype.negate = function () {\r\n        return new BigInteger(this.value, !this.sign);\r\n    };\r\n    SmallInteger.prototype.negate = function () {\r\n        var sign = this.sign;\r\n        var small = new SmallInteger(-this.value);\r\n        small.sign = !sign;\r\n        return small;\r\n    };\r\n    NativeBigInt.prototype.negate = function () {\r\n        return new NativeBigInt(-this.value);\r\n    }\r\n\r\n    BigInteger.prototype.abs = function () {\r\n        return new BigInteger(this.value, false);\r\n    };\r\n    SmallInteger.prototype.abs = function () {\r\n        return new SmallInteger(Math.abs(this.value));\r\n    };\r\n    NativeBigInt.prototype.abs = function () {\r\n        return new NativeBigInt(this.value >= 0 ? this.value : -this.value);\r\n    }\r\n\r\n\r\n    function multiplyLong(a, b) {\r\n        var a_l = a.length,\r\n            b_l = b.length,\r\n            l = a_l + b_l,\r\n            r = createArray(l),\r\n            base = BASE,\r\n            product, carry, i, a_i, b_j;\r\n        for (i = 0; i < a_l; ++i) {\r\n            a_i = a[i];\r\n            for (var j = 0; j < b_l; ++j) {\r\n                b_j = b[j];\r\n                product = a_i * b_j + r[i + j];\r\n                carry = Math.floor(product / base);\r\n                r[i + j] = product - carry * base;\r\n                r[i + j + 1] += carry;\r\n            }\r\n        }\r\n        trim(r);\r\n        return r;\r\n    }\r\n\r\n    function multiplySmall(a, b) { // assumes a is array, b is number with |b| < BASE\r\n        var l = a.length,\r\n            r = new Array(l),\r\n            base = BASE,\r\n            carry = 0,\r\n            product, i;\r\n        for (i = 0; i < l; i++) {\r\n            product = a[i] * b + carry;\r\n            carry = Math.floor(product / base);\r\n            r[i] = product - carry * base;\r\n        }\r\n        while (carry > 0) {\r\n            r[i++] = carry % base;\r\n            carry = Math.floor(carry / base);\r\n        }\r\n        return r;\r\n    }\r\n\r\n    function shiftLeft(x, n) {\r\n        var r = [];\r\n        while (n-- > 0) r.push(0);\r\n        return r.concat(x);\r\n    }\r\n\r\n    function multiplyKaratsuba(x, y) {\r\n        var n = Math.max(x.length, y.length);\r\n\r\n        if (n <= 30) return multiplyLong(x, y);\r\n        n = Math.ceil(n / 2);\r\n\r\n        var b = x.slice(n),\r\n            a = x.slice(0, n),\r\n            d = y.slice(n),\r\n            c = y.slice(0, n);\r\n\r\n        var ac = multiplyKaratsuba(a, c),\r\n            bd = multiplyKaratsuba(b, d),\r\n            abcd = multiplyKaratsuba(addAny(a, b), addAny(c, d));\r\n\r\n        var product = addAny(addAny(ac, shiftLeft(subtract(subtract(abcd, ac), bd), n)), shiftLeft(bd, 2 * n));\r\n        trim(product);\r\n        return product;\r\n    }\r\n\r\n    // The following function is derived from a surface fit of a graph plotting the performance difference\r\n    // between long multiplication and karatsuba multiplication versus the lengths of the two arrays.\r\n    function useKaratsuba(l1, l2) {\r\n        return -0.012 * l1 - 0.012 * l2 + 0.000015 * l1 * l2 > 0;\r\n    }\r\n\r\n    BigInteger.prototype.multiply = function (v) {\r\n        var n = parseValue(v),\r\n            a = this.value, b = n.value,\r\n            sign = this.sign !== n.sign,\r\n            abs;\r\n        if (n.isSmall) {\r\n            if (b === 0) return Integer[0];\r\n            if (b === 1) return this;\r\n            if (b === -1) return this.negate();\r\n            abs = Math.abs(b);\r\n            if (abs < BASE) {\r\n                return new BigInteger(multiplySmall(a, abs), sign);\r\n            }\r\n            b = smallToArray(abs);\r\n        }\r\n        if (useKaratsuba(a.length, b.length)) // Karatsuba is only faster for certain array sizes\r\n            return new BigInteger(multiplyKaratsuba(a, b), sign);\r\n        return new BigInteger(multiplyLong(a, b), sign);\r\n    };\r\n\r\n    BigInteger.prototype.times = BigInteger.prototype.multiply;\r\n\r\n    function multiplySmallAndArray(a, b, sign) { // a >= 0\r\n        if (a < BASE) {\r\n            return new BigInteger(multiplySmall(b, a), sign);\r\n        }\r\n        return new BigInteger(multiplyLong(b, smallToArray(a)), sign);\r\n    }\r\n    SmallInteger.prototype._multiplyBySmall = function (a) {\r\n        if (isPrecise(a.value * this.value)) {\r\n            return new SmallInteger(a.value * this.value);\r\n        }\r\n        return multiplySmallAndArray(Math.abs(a.value), smallToArray(Math.abs(this.value)), this.sign !== a.sign);\r\n    };\r\n    BigInteger.prototype._multiplyBySmall = function (a) {\r\n        if (a.value === 0) return Integer[0];\r\n        if (a.value === 1) return this;\r\n        if (a.value === -1) return this.negate();\r\n        return multiplySmallAndArray(Math.abs(a.value), this.value, this.sign !== a.sign);\r\n    };\r\n    SmallInteger.prototype.multiply = function (v) {\r\n        return parseValue(v)._multiplyBySmall(this);\r\n    };\r\n    SmallInteger.prototype.times = SmallInteger.prototype.multiply;\r\n\r\n    NativeBigInt.prototype.multiply = function (v) {\r\n        return new NativeBigInt(this.value * parseValue(v).value);\r\n    }\r\n    NativeBigInt.prototype.times = NativeBigInt.prototype.multiply;\r\n\r\n    function square(a) {\r\n        //console.assert(2 * BASE * BASE < MAX_INT);\r\n        var l = a.length,\r\n            r = createArray(l + l),\r\n            base = BASE,\r\n            product, carry, i, a_i, a_j;\r\n        for (i = 0; i < l; i++) {\r\n            a_i = a[i];\r\n            carry = 0 - a_i * a_i;\r\n            for (var j = i; j < l; j++) {\r\n                a_j = a[j];\r\n                product = 2 * (a_i * a_j) + r[i + j] + carry;\r\n                carry = Math.floor(product / base);\r\n                r[i + j] = product - carry * base;\r\n            }\r\n            r[i + l] = carry;\r\n        }\r\n        trim(r);\r\n        return r;\r\n    }\r\n\r\n    BigInteger.prototype.square = function () {\r\n        return new BigInteger(square(this.value), false);\r\n    };\r\n\r\n    SmallInteger.prototype.square = function () {\r\n        var value = this.value * this.value;\r\n        if (isPrecise(value)) return new SmallInteger(value);\r\n        return new BigInteger(square(smallToArray(Math.abs(this.value))), false);\r\n    };\r\n\r\n    NativeBigInt.prototype.square = function (v) {\r\n        return new NativeBigInt(this.value * this.value);\r\n    }\r\n\r\n    function divMod1(a, b) { // Left over from previous version. Performs faster than divMod2 on smaller input sizes.\r\n        var a_l = a.length,\r\n            b_l = b.length,\r\n            base = BASE,\r\n            result = createArray(b.length),\r\n            divisorMostSignificantDigit = b[b_l - 1],\r\n            // normalization\r\n            lambda = Math.ceil(base / (2 * divisorMostSignificantDigit)),\r\n            remainder = multiplySmall(a, lambda),\r\n            divisor = multiplySmall(b, lambda),\r\n            quotientDigit, shift, carry, borrow, i, l, q;\r\n        if (remainder.length <= a_l) remainder.push(0);\r\n        divisor.push(0);\r\n        divisorMostSignificantDigit = divisor[b_l - 1];\r\n        for (shift = a_l - b_l; shift >= 0; shift--) {\r\n            quotientDigit = base - 1;\r\n            if (remainder[shift + b_l] !== divisorMostSignificantDigit) {\r\n                quotientDigit = Math.floor((remainder[shift + b_l] * base + remainder[shift + b_l - 1]) / divisorMostSignificantDigit);\r\n            }\r\n            // quotientDigit <= base - 1\r\n            carry = 0;\r\n            borrow = 0;\r\n            l = divisor.length;\r\n            for (i = 0; i < l; i++) {\r\n                carry += quotientDigit * divisor[i];\r\n                q = Math.floor(carry / base);\r\n                borrow += remainder[shift + i] - (carry - q * base);\r\n                carry = q;\r\n                if (borrow < 0) {\r\n                    remainder[shift + i] = borrow + base;\r\n                    borrow = -1;\r\n                } else {\r\n                    remainder[shift + i] = borrow;\r\n                    borrow = 0;\r\n                }\r\n            }\r\n            while (borrow !== 0) {\r\n                quotientDigit -= 1;\r\n                carry = 0;\r\n                for (i = 0; i < l; i++) {\r\n                    carry += remainder[shift + i] - base + divisor[i];\r\n                    if (carry < 0) {\r\n                        remainder[shift + i] = carry + base;\r\n                        carry = 0;\r\n                    } else {\r\n                        remainder[shift + i] = carry;\r\n                        carry = 1;\r\n                    }\r\n                }\r\n                borrow += carry;\r\n            }\r\n            result[shift] = quotientDigit;\r\n        }\r\n        // denormalization\r\n        remainder = divModSmall(remainder, lambda)[0];\r\n        return [arrayToSmall(result), arrayToSmall(remainder)];\r\n    }\r\n\r\n    function divMod2(a, b) { // Implementation idea shamelessly stolen from Silent Matt's library http://silentmatt.com/biginteger/\r\n        // Performs faster than divMod1 on larger input sizes.\r\n        var a_l = a.length,\r\n            b_l = b.length,\r\n            result = [],\r\n            part = [],\r\n            base = BASE,\r\n            guess, xlen, highx, highy, check;\r\n        while (a_l) {\r\n            part.unshift(a[--a_l]);\r\n            trim(part);\r\n            if (compareAbs(part, b) < 0) {\r\n                result.push(0);\r\n                continue;\r\n            }\r\n            xlen = part.length;\r\n            highx = part[xlen - 1] * base + part[xlen - 2];\r\n            highy = b[b_l - 1] * base + b[b_l - 2];\r\n            if (xlen > b_l) {\r\n                highx = (highx + 1) * base;\r\n            }\r\n            guess = Math.ceil(highx / highy);\r\n            do {\r\n                check = multiplySmall(b, guess);\r\n                if (compareAbs(check, part) <= 0) break;\r\n                guess--;\r\n            } while (guess);\r\n            result.push(guess);\r\n            part = subtract(part, check);\r\n        }\r\n        result.reverse();\r\n        return [arrayToSmall(result), arrayToSmall(part)];\r\n    }\r\n\r\n    function divModSmall(value, lambda) {\r\n        var length = value.length,\r\n            quotient = createArray(length),\r\n            base = BASE,\r\n            i, q, remainder, divisor;\r\n        remainder = 0;\r\n        for (i = length - 1; i >= 0; --i) {\r\n            divisor = remainder * base + value[i];\r\n            q = truncate(divisor / lambda);\r\n            remainder = divisor - q * lambda;\r\n            quotient[i] = q | 0;\r\n        }\r\n        return [quotient, remainder | 0];\r\n    }\r\n\r\n    function divModAny(self, v) {\r\n        var value, n = parseValue(v);\r\n        if (supportsNativeBigInt) {\r\n            return [new NativeBigInt(self.value / n.value), new NativeBigInt(self.value % n.value)];\r\n        }\r\n        var a = self.value, b = n.value;\r\n        var quotient;\r\n        if (b === 0) throw new Error(\"Cannot divide by zero\");\r\n        if (self.isSmall) {\r\n            if (n.isSmall) {\r\n                return [new SmallInteger(truncate(a / b)), new SmallInteger(a % b)];\r\n            }\r\n            return [Integer[0], self];\r\n        }\r\n        if (n.isSmall) {\r\n            if (b === 1) return [self, Integer[0]];\r\n            if (b == -1) return [self.negate(), Integer[0]];\r\n            var abs = Math.abs(b);\r\n            if (abs < BASE) {\r\n                value = divModSmall(a, abs);\r\n                quotient = arrayToSmall(value[0]);\r\n                var remainder = value[1];\r\n                if (self.sign) remainder = -remainder;\r\n                if (typeof quotient === \"number\") {\r\n                    if (self.sign !== n.sign) quotient = -quotient;\r\n                    return [new SmallInteger(quotient), new SmallInteger(remainder)];\r\n                }\r\n                return [new BigInteger(quotient, self.sign !== n.sign), new SmallInteger(remainder)];\r\n            }\r\n            b = smallToArray(abs);\r\n        }\r\n        var comparison = compareAbs(a, b);\r\n        if (comparison === -1) return [Integer[0], self];\r\n        if (comparison === 0) return [Integer[self.sign === n.sign ? 1 : -1], Integer[0]];\r\n\r\n        // divMod1 is faster on smaller input sizes\r\n        if (a.length + b.length <= 200)\r\n            value = divMod1(a, b);\r\n        else value = divMod2(a, b);\r\n\r\n        quotient = value[0];\r\n        var qSign = self.sign !== n.sign,\r\n            mod = value[1],\r\n            mSign = self.sign;\r\n        if (typeof quotient === \"number\") {\r\n            if (qSign) quotient = -quotient;\r\n            quotient = new SmallInteger(quotient);\r\n        } else quotient = new BigInteger(quotient, qSign);\r\n        if (typeof mod === \"number\") {\r\n            if (mSign) mod = -mod;\r\n            mod = new SmallInteger(mod);\r\n        } else mod = new BigInteger(mod, mSign);\r\n        return [quotient, mod];\r\n    }\r\n\r\n    BigInteger.prototype.divmod = function (v) {\r\n        var result = divModAny(this, v);\r\n        return {\r\n            quotient: result[0],\r\n            remainder: result[1]\r\n        };\r\n    };\r\n    NativeBigInt.prototype.divmod = SmallInteger.prototype.divmod = BigInteger.prototype.divmod;\r\n\r\n\r\n    BigInteger.prototype.divide = function (v) {\r\n        return divModAny(this, v)[0];\r\n    };\r\n    NativeBigInt.prototype.over = NativeBigInt.prototype.divide = function (v) {\r\n        return new NativeBigInt(this.value / parseValue(v).value);\r\n    };\r\n    SmallInteger.prototype.over = SmallInteger.prototype.divide = BigInteger.prototype.over = BigInteger.prototype.divide;\r\n\r\n    BigInteger.prototype.mod = function (v) {\r\n        return divModAny(this, v)[1];\r\n    };\r\n    NativeBigInt.prototype.mod = NativeBigInt.prototype.remainder = function (v) {\r\n        return new NativeBigInt(this.value % parseValue(v).value);\r\n    };\r\n    SmallInteger.prototype.remainder = SmallInteger.prototype.mod = BigInteger.prototype.remainder = BigInteger.prototype.mod;\r\n\r\n    BigInteger.prototype.pow = function (v) {\r\n        var n = parseValue(v),\r\n            a = this.value,\r\n            b = n.value,\r\n            value, x, y;\r\n        if (b === 0) return Integer[1];\r\n        if (a === 0) return Integer[0];\r\n        if (a === 1) return Integer[1];\r\n        if (a === -1) return n.isEven() ? Integer[1] : Integer[-1];\r\n        if (n.sign) {\r\n            return Integer[0];\r\n        }\r\n        if (!n.isSmall) throw new Error(\"The exponent \" + n.toString() + \" is too large.\");\r\n        if (this.isSmall) {\r\n            if (isPrecise(value = Math.pow(a, b)))\r\n                return new SmallInteger(truncate(value));\r\n        }\r\n        x = this;\r\n        y = Integer[1];\r\n        while (true) {\r\n            if (b & 1 === 1) {\r\n                y = y.times(x);\r\n                --b;\r\n            }\r\n            if (b === 0) break;\r\n            b /= 2;\r\n            x = x.square();\r\n        }\r\n        return y;\r\n    };\r\n    SmallInteger.prototype.pow = BigInteger.prototype.pow;\r\n\r\n    NativeBigInt.prototype.pow = function (v) {\r\n        var n = parseValue(v);\r\n        var a = this.value, b = n.value;\r\n        var _0 = BigInt(0), _1 = BigInt(1), _2 = BigInt(2);\r\n        if (b === _0) return Integer[1];\r\n        if (a === _0) return Integer[0];\r\n        if (a === _1) return Integer[1];\r\n        if (a === BigInt(-1)) return n.isEven() ? Integer[1] : Integer[-1];\r\n        if (n.isNegative()) return new NativeBigInt(_0);\r\n        var x = this;\r\n        var y = Integer[1];\r\n        while (true) {\r\n            if ((b & _1) === _1) {\r\n                y = y.times(x);\r\n                --b;\r\n            }\r\n            if (b === _0) break;\r\n            b /= _2;\r\n            x = x.square();\r\n        }\r\n        return y;\r\n    }\r\n\r\n    BigInteger.prototype.modPow = function (exp, mod) {\r\n        exp = parseValue(exp);\r\n        mod = parseValue(mod);\r\n        if (mod.isZero()) throw new Error(\"Cannot take modPow with modulus 0\");\r\n        var r = Integer[1],\r\n            base = this.mod(mod);\r\n        if (exp.isNegative()) {\r\n            exp = exp.multiply(Integer[-1]);\r\n            base = base.modInv(mod);\r\n        }\r\n        while (exp.isPositive()) {\r\n            if (base.isZero()) return Integer[0];\r\n            if (exp.isOdd()) r = r.multiply(base).mod(mod);\r\n            exp = exp.divide(2);\r\n            base = base.square().mod(mod);\r\n        }\r\n        return r;\r\n    };\r\n    NativeBigInt.prototype.modPow = SmallInteger.prototype.modPow = BigInteger.prototype.modPow;\r\n\r\n    function compareAbs(a, b) {\r\n        if (a.length !== b.length) {\r\n            return a.length > b.length ? 1 : -1;\r\n        }\r\n        for (var i = a.length - 1; i >= 0; i--) {\r\n            if (a[i] !== b[i]) return a[i] > b[i] ? 1 : -1;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    BigInteger.prototype.compareAbs = function (v) {\r\n        var n = parseValue(v),\r\n            a = this.value,\r\n            b = n.value;\r\n        if (n.isSmall) return 1;\r\n        return compareAbs(a, b);\r\n    };\r\n    SmallInteger.prototype.compareAbs = function (v) {\r\n        var n = parseValue(v),\r\n            a = Math.abs(this.value),\r\n            b = n.value;\r\n        if (n.isSmall) {\r\n            b = Math.abs(b);\r\n            return a === b ? 0 : a > b ? 1 : -1;\r\n        }\r\n        return -1;\r\n    };\r\n    NativeBigInt.prototype.compareAbs = function (v) {\r\n        var a = this.value;\r\n        var b = parseValue(v).value;\r\n        a = a >= 0 ? a : -a;\r\n        b = b >= 0 ? b : -b;\r\n        return a === b ? 0 : a > b ? 1 : -1;\r\n    }\r\n\r\n    BigInteger.prototype.compare = function (v) {\r\n        // See discussion about comparison with Infinity:\r\n        // https://github.com/peterolson/BigInteger.js/issues/61\r\n        if (v === Infinity) {\r\n            return -1;\r\n        }\r\n        if (v === -Infinity) {\r\n            return 1;\r\n        }\r\n\r\n        var n = parseValue(v),\r\n            a = this.value,\r\n            b = n.value;\r\n        if (this.sign !== n.sign) {\r\n            return n.sign ? 1 : -1;\r\n        }\r\n        if (n.isSmall) {\r\n            return this.sign ? -1 : 1;\r\n        }\r\n        return compareAbs(a, b) * (this.sign ? -1 : 1);\r\n    };\r\n    BigInteger.prototype.compareTo = BigInteger.prototype.compare;\r\n\r\n    SmallInteger.prototype.compare = function (v) {\r\n        if (v === Infinity) {\r\n            return -1;\r\n        }\r\n        if (v === -Infinity) {\r\n            return 1;\r\n        }\r\n\r\n        var n = parseValue(v),\r\n            a = this.value,\r\n            b = n.value;\r\n        if (n.isSmall) {\r\n            return a == b ? 0 : a > b ? 1 : -1;\r\n        }\r\n        if (a < 0 !== n.sign) {\r\n            return a < 0 ? -1 : 1;\r\n        }\r\n        return a < 0 ? 1 : -1;\r\n    };\r\n    SmallInteger.prototype.compareTo = SmallInteger.prototype.compare;\r\n\r\n    NativeBigInt.prototype.compare = function (v) {\r\n        if (v === Infinity) {\r\n            return -1;\r\n        }\r\n        if (v === -Infinity) {\r\n            return 1;\r\n        }\r\n        var a = this.value;\r\n        var b = parseValue(v).value;\r\n        return a === b ? 0 : a > b ? 1 : -1;\r\n    }\r\n    NativeBigInt.prototype.compareTo = NativeBigInt.prototype.compare;\r\n\r\n    BigInteger.prototype.equals = function (v) {\r\n        return this.compare(v) === 0;\r\n    };\r\n    NativeBigInt.prototype.eq = NativeBigInt.prototype.equals = SmallInteger.prototype.eq = SmallInteger.prototype.equals = BigInteger.prototype.eq = BigInteger.prototype.equals;\r\n\r\n    BigInteger.prototype.notEquals = function (v) {\r\n        return this.compare(v) !== 0;\r\n    };\r\n    NativeBigInt.prototype.neq = NativeBigInt.prototype.notEquals = SmallInteger.prototype.neq = SmallInteger.prototype.notEquals = BigInteger.prototype.neq = BigInteger.prototype.notEquals;\r\n\r\n    BigInteger.prototype.greater = function (v) {\r\n        return this.compare(v) > 0;\r\n    };\r\n    NativeBigInt.prototype.gt = NativeBigInt.prototype.greater = SmallInteger.prototype.gt = SmallInteger.prototype.greater = BigInteger.prototype.gt = BigInteger.prototype.greater;\r\n\r\n    BigInteger.prototype.lesser = function (v) {\r\n        return this.compare(v) < 0;\r\n    };\r\n    NativeBigInt.prototype.lt = NativeBigInt.prototype.lesser = SmallInteger.prototype.lt = SmallInteger.prototype.lesser = BigInteger.prototype.lt = BigInteger.prototype.lesser;\r\n\r\n    BigInteger.prototype.greaterOrEquals = function (v) {\r\n        return this.compare(v) >= 0;\r\n    };\r\n    NativeBigInt.prototype.geq = NativeBigInt.prototype.greaterOrEquals = SmallInteger.prototype.geq = SmallInteger.prototype.greaterOrEquals = BigInteger.prototype.geq = BigInteger.prototype.greaterOrEquals;\r\n\r\n    BigInteger.prototype.lesserOrEquals = function (v) {\r\n        return this.compare(v) <= 0;\r\n    };\r\n    NativeBigInt.prototype.leq = NativeBigInt.prototype.lesserOrEquals = SmallInteger.prototype.leq = SmallInteger.prototype.lesserOrEquals = BigInteger.prototype.leq = BigInteger.prototype.lesserOrEquals;\r\n\r\n    BigInteger.prototype.isEven = function () {\r\n        return (this.value[0] & 1) === 0;\r\n    };\r\n    SmallInteger.prototype.isEven = function () {\r\n        return (this.value & 1) === 0;\r\n    };\r\n    NativeBigInt.prototype.isEven = function () {\r\n        return (this.value & BigInt(1)) === BigInt(0);\r\n    }\r\n\r\n    BigInteger.prototype.isOdd = function () {\r\n        return (this.value[0] & 1) === 1;\r\n    };\r\n    SmallInteger.prototype.isOdd = function () {\r\n        return (this.value & 1) === 1;\r\n    };\r\n    NativeBigInt.prototype.isOdd = function () {\r\n        return (this.value & BigInt(1)) === BigInt(1);\r\n    }\r\n\r\n    BigInteger.prototype.isPositive = function () {\r\n        return !this.sign;\r\n    };\r\n    SmallInteger.prototype.isPositive = function () {\r\n        return this.value > 0;\r\n    };\r\n    NativeBigInt.prototype.isPositive = SmallInteger.prototype.isPositive;\r\n\r\n    BigInteger.prototype.isNegative = function () {\r\n        return this.sign;\r\n    };\r\n    SmallInteger.prototype.isNegative = function () {\r\n        return this.value < 0;\r\n    };\r\n    NativeBigInt.prototype.isNegative = SmallInteger.prototype.isNegative;\r\n\r\n    BigInteger.prototype.isUnit = function () {\r\n        return false;\r\n    };\r\n    SmallInteger.prototype.isUnit = function () {\r\n        return Math.abs(this.value) === 1;\r\n    };\r\n    NativeBigInt.prototype.isUnit = function () {\r\n        return this.abs().value === BigInt(1);\r\n    }\r\n\r\n    BigInteger.prototype.isZero = function () {\r\n        return false;\r\n    };\r\n    SmallInteger.prototype.isZero = function () {\r\n        return this.value === 0;\r\n    };\r\n    NativeBigInt.prototype.isZero = function () {\r\n        return this.value === BigInt(0);\r\n    }\r\n\r\n    BigInteger.prototype.isDivisibleBy = function (v) {\r\n        var n = parseValue(v);\r\n        if (n.isZero()) return false;\r\n        if (n.isUnit()) return true;\r\n        if (n.compareAbs(2) === 0) return this.isEven();\r\n        return this.mod(n).isZero();\r\n    };\r\n    NativeBigInt.prototype.isDivisibleBy = SmallInteger.prototype.isDivisibleBy = BigInteger.prototype.isDivisibleBy;\r\n\r\n    function isBasicPrime(v) {\r\n        var n = v.abs();\r\n        if (n.isUnit()) return false;\r\n        if (n.equals(2) || n.equals(3) || n.equals(5)) return true;\r\n        if (n.isEven() || n.isDivisibleBy(3) || n.isDivisibleBy(5)) return false;\r\n        if (n.lesser(49)) return true;\r\n        // we don't know if it's prime: let the other functions figure it out\r\n    }\r\n\r\n    function millerRabinTest(n, a) {\r\n        var nPrev = n.prev(),\r\n            b = nPrev,\r\n            r = 0,\r\n            d, t, i, x;\r\n        while (b.isEven()) b = b.divide(2), r++;\r\n        next: for (i = 0; i < a.length; i++) {\r\n            if (n.lesser(a[i])) continue;\r\n            x = bigInt(a[i]).modPow(b, n);\r\n            if (x.isUnit() || x.equals(nPrev)) continue;\r\n            for (d = r - 1; d != 0; d--) {\r\n                x = x.square().mod(n);\r\n                if (x.isUnit()) return false;\r\n                if (x.equals(nPrev)) continue next;\r\n            }\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    // Set \"strict\" to true to force GRH-supported lower bound of 2*log(N)^2\r\n    BigInteger.prototype.isPrime = function (strict) {\r\n        var isPrime = isBasicPrime(this);\r\n        if (isPrime !== undefined) return isPrime;\r\n        var n = this.abs();\r\n        var bits = n.bitLength();\r\n        if (bits <= 64)\r\n            return millerRabinTest(n, [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37]);\r\n        var logN = Math.log(2) * bits.toJSNumber();\r\n        var t = Math.ceil((strict === true) ? (2 * Math.pow(logN, 2)) : logN);\r\n        for (var a = [], i = 0; i < t; i++) {\r\n            a.push(bigInt(i + 2));\r\n        }\r\n        return millerRabinTest(n, a);\r\n    };\r\n    NativeBigInt.prototype.isPrime = SmallInteger.prototype.isPrime = BigInteger.prototype.isPrime;\r\n\r\n    BigInteger.prototype.isProbablePrime = function (iterations, rng) {\r\n        var isPrime = isBasicPrime(this);\r\n        if (isPrime !== undefined) return isPrime;\r\n        var n = this.abs();\r\n        var t = iterations === undefined ? 5 : iterations;\r\n        for (var a = [], i = 0; i < t; i++) {\r\n            a.push(bigInt.randBetween(2, n.minus(2), rng));\r\n        }\r\n        return millerRabinTest(n, a);\r\n    };\r\n    NativeBigInt.prototype.isProbablePrime = SmallInteger.prototype.isProbablePrime = BigInteger.prototype.isProbablePrime;\r\n\r\n    BigInteger.prototype.modInv = function (n) {\r\n        var t = bigInt.zero, newT = bigInt.one, r = parseValue(n), newR = this.abs(), q, lastT, lastR;\r\n        while (!newR.isZero()) {\r\n            q = r.divide(newR);\r\n            lastT = t;\r\n            lastR = r;\r\n            t = newT;\r\n            r = newR;\r\n            newT = lastT.subtract(q.multiply(newT));\r\n            newR = lastR.subtract(q.multiply(newR));\r\n        }\r\n        if (!r.isUnit()) throw new Error(this.toString() + \" and \" + n.toString() + \" are not co-prime\");\r\n        if (t.compare(0) === -1) {\r\n            t = t.add(n);\r\n        }\r\n        if (this.isNegative()) {\r\n            return t.negate();\r\n        }\r\n        return t;\r\n    };\r\n\r\n    NativeBigInt.prototype.modInv = SmallInteger.prototype.modInv = BigInteger.prototype.modInv;\r\n\r\n    BigInteger.prototype.next = function () {\r\n        var value = this.value;\r\n        if (this.sign) {\r\n            return subtractSmall(value, 1, this.sign);\r\n        }\r\n        return new BigInteger(addSmall(value, 1), this.sign);\r\n    };\r\n    SmallInteger.prototype.next = function () {\r\n        var value = this.value;\r\n        if (value + 1 < MAX_INT) return new SmallInteger(value + 1);\r\n        return new BigInteger(MAX_INT_ARR, false);\r\n    };\r\n    NativeBigInt.prototype.next = function () {\r\n        return new NativeBigInt(this.value + BigInt(1));\r\n    }\r\n\r\n    BigInteger.prototype.prev = function () {\r\n        var value = this.value;\r\n        if (this.sign) {\r\n            return new BigInteger(addSmall(value, 1), true);\r\n        }\r\n        return subtractSmall(value, 1, this.sign);\r\n    };\r\n    SmallInteger.prototype.prev = function () {\r\n        var value = this.value;\r\n        if (value - 1 > -MAX_INT) return new SmallInteger(value - 1);\r\n        return new BigInteger(MAX_INT_ARR, true);\r\n    };\r\n    NativeBigInt.prototype.prev = function () {\r\n        return new NativeBigInt(this.value - BigInt(1));\r\n    }\r\n\r\n    var powersOfTwo = [1];\r\n    while (2 * powersOfTwo[powersOfTwo.length - 1] <= BASE) powersOfTwo.push(2 * powersOfTwo[powersOfTwo.length - 1]);\r\n    var powers2Length = powersOfTwo.length, highestPower2 = powersOfTwo[powers2Length - 1];\r\n\r\n    function shift_isSmall(n) {\r\n        return Math.abs(n) <= BASE;\r\n    }\r\n\r\n    BigInteger.prototype.shiftLeft = function (v) {\r\n        var n = parseValue(v).toJSNumber();\r\n        if (!shift_isSmall(n)) {\r\n            throw new Error(String(n) + \" is too large for shifting.\");\r\n        }\r\n        if (n < 0) return this.shiftRight(-n);\r\n        var result = this;\r\n        if (result.isZero()) return result;\r\n        while (n >= powers2Length) {\r\n            result = result.multiply(highestPower2);\r\n            n -= powers2Length - 1;\r\n        }\r\n        return result.multiply(powersOfTwo[n]);\r\n    };\r\n    NativeBigInt.prototype.shiftLeft = SmallInteger.prototype.shiftLeft = BigInteger.prototype.shiftLeft;\r\n\r\n    BigInteger.prototype.shiftRight = function (v) {\r\n        var remQuo;\r\n        var n = parseValue(v).toJSNumber();\r\n        if (!shift_isSmall(n)) {\r\n            throw new Error(String(n) + \" is too large for shifting.\");\r\n        }\r\n        if (n < 0) return this.shiftLeft(-n);\r\n        var result = this;\r\n        while (n >= powers2Length) {\r\n            if (result.isZero() || (result.isNegative() && result.isUnit())) return result;\r\n            remQuo = divModAny(result, highestPower2);\r\n            result = remQuo[1].isNegative() ? remQuo[0].prev() : remQuo[0];\r\n            n -= powers2Length - 1;\r\n        }\r\n        remQuo = divModAny(result, powersOfTwo[n]);\r\n        return remQuo[1].isNegative() ? remQuo[0].prev() : remQuo[0];\r\n    };\r\n    NativeBigInt.prototype.shiftRight = SmallInteger.prototype.shiftRight = BigInteger.prototype.shiftRight;\r\n\r\n    function bitwise(x, y, fn) {\r\n        y = parseValue(y);\r\n        var xSign = x.isNegative(), ySign = y.isNegative();\r\n        var xRem = xSign ? x.not() : x,\r\n            yRem = ySign ? y.not() : y;\r\n        var xDigit = 0, yDigit = 0;\r\n        var xDivMod = null, yDivMod = null;\r\n        var result = [];\r\n        while (!xRem.isZero() || !yRem.isZero()) {\r\n            xDivMod = divModAny(xRem, highestPower2);\r\n            xDigit = xDivMod[1].toJSNumber();\r\n            if (xSign) {\r\n                xDigit = highestPower2 - 1 - xDigit; // two's complement for negative numbers\r\n            }\r\n\r\n            yDivMod = divModAny(yRem, highestPower2);\r\n            yDigit = yDivMod[1].toJSNumber();\r\n            if (ySign) {\r\n                yDigit = highestPower2 - 1 - yDigit; // two's complement for negative numbers\r\n            }\r\n\r\n            xRem = xDivMod[0];\r\n            yRem = yDivMod[0];\r\n            result.push(fn(xDigit, yDigit));\r\n        }\r\n        var sum = fn(xSign ? 1 : 0, ySign ? 1 : 0) !== 0 ? bigInt(-1) : bigInt(0);\r\n        for (var i = result.length - 1; i >= 0; i -= 1) {\r\n            sum = sum.multiply(highestPower2).add(bigInt(result[i]));\r\n        }\r\n        return sum;\r\n    }\r\n\r\n    BigInteger.prototype.not = function () {\r\n        return this.negate().prev();\r\n    };\r\n    NativeBigInt.prototype.not = SmallInteger.prototype.not = BigInteger.prototype.not;\r\n\r\n    BigInteger.prototype.and = function (n) {\r\n        return bitwise(this, n, function (a, b) { return a & b; });\r\n    };\r\n    NativeBigInt.prototype.and = SmallInteger.prototype.and = BigInteger.prototype.and;\r\n\r\n    BigInteger.prototype.or = function (n) {\r\n        return bitwise(this, n, function (a, b) { return a | b; });\r\n    };\r\n    NativeBigInt.prototype.or = SmallInteger.prototype.or = BigInteger.prototype.or;\r\n\r\n    BigInteger.prototype.xor = function (n) {\r\n        return bitwise(this, n, function (a, b) { return a ^ b; });\r\n    };\r\n    NativeBigInt.prototype.xor = SmallInteger.prototype.xor = BigInteger.prototype.xor;\r\n\r\n    var LOBMASK_I = 1 << 30, LOBMASK_BI = (BASE & -BASE) * (BASE & -BASE) | LOBMASK_I;\r\n    function roughLOB(n) { // get lowestOneBit (rough)\r\n        // SmallInteger: return Min(lowestOneBit(n), 1 << 30)\r\n        // BigInteger: return Min(lowestOneBit(n), 1 << 14) [BASE=1e7]\r\n        var v = n.value,\r\n            x = typeof v === \"number\" ? v | LOBMASK_I :\r\n                typeof v === \"bigint\" ? v | BigInt(LOBMASK_I) :\r\n                    v[0] + v[1] * BASE | LOBMASK_BI;\r\n        return x & -x;\r\n    }\r\n\r\n    function integerLogarithm(value, base) {\r\n        if (base.compareTo(value) <= 0) {\r\n            var tmp = integerLogarithm(value, base.square(base));\r\n            var p = tmp.p;\r\n            var e = tmp.e;\r\n            var t = p.multiply(base);\r\n            return t.compareTo(value) <= 0 ? { p: t, e: e * 2 + 1 } : { p: p, e: e * 2 };\r\n        }\r\n        return { p: bigInt(1), e: 0 };\r\n    }\r\n\r\n    BigInteger.prototype.bitLength = function () {\r\n        var n = this;\r\n        if (n.compareTo(bigInt(0)) < 0) {\r\n            n = n.negate().subtract(bigInt(1));\r\n        }\r\n        if (n.compareTo(bigInt(0)) === 0) {\r\n            return bigInt(0);\r\n        }\r\n        return bigInt(integerLogarithm(n, bigInt(2)).e).add(bigInt(1));\r\n    }\r\n    NativeBigInt.prototype.bitLength = SmallInteger.prototype.bitLength = BigInteger.prototype.bitLength;\r\n\r\n    function max(a, b) {\r\n        a = parseValue(a);\r\n        b = parseValue(b);\r\n        return a.greater(b) ? a : b;\r\n    }\r\n    function min(a, b) {\r\n        a = parseValue(a);\r\n        b = parseValue(b);\r\n        return a.lesser(b) ? a : b;\r\n    }\r\n    function gcd(a, b) {\r\n        a = parseValue(a).abs();\r\n        b = parseValue(b).abs();\r\n        if (a.equals(b)) return a;\r\n        if (a.isZero()) return b;\r\n        if (b.isZero()) return a;\r\n        var c = Integer[1], d, t;\r\n        while (a.isEven() && b.isEven()) {\r\n            d = min(roughLOB(a), roughLOB(b));\r\n            a = a.divide(d);\r\n            b = b.divide(d);\r\n            c = c.multiply(d);\r\n        }\r\n        while (a.isEven()) {\r\n            a = a.divide(roughLOB(a));\r\n        }\r\n        do {\r\n            while (b.isEven()) {\r\n                b = b.divide(roughLOB(b));\r\n            }\r\n            if (a.greater(b)) {\r\n                t = b; b = a; a = t;\r\n            }\r\n            b = b.subtract(a);\r\n        } while (!b.isZero());\r\n        return c.isUnit() ? a : a.multiply(c);\r\n    }\r\n    function lcm(a, b) {\r\n        a = parseValue(a).abs();\r\n        b = parseValue(b).abs();\r\n        return a.divide(gcd(a, b)).multiply(b);\r\n    }\r\n    function randBetween(a, b, rng) {\r\n        a = parseValue(a);\r\n        b = parseValue(b);\r\n        var usedRNG = rng || Math.random;\r\n        var low = min(a, b), high = max(a, b);\r\n        var range = high.subtract(low).add(1);\r\n        if (range.isSmall) return low.add(Math.floor(usedRNG() * range));\r\n        var digits = toBase(range, BASE).value;\r\n        var result = [], restricted = true;\r\n        for (var i = 0; i < digits.length; i++) {\r\n            var top = restricted ? digits[i] : BASE;\r\n            var digit = truncate(usedRNG() * top);\r\n            result.push(digit);\r\n            if (digit < top) restricted = false;\r\n        }\r\n        return low.add(Integer.fromArray(result, BASE, false));\r\n    }\r\n\r\n    var parseBase = function (text, base, alphabet, caseSensitive) {\r\n        alphabet = alphabet || DEFAULT_ALPHABET;\r\n        text = String(text);\r\n        if (!caseSensitive) {\r\n            text = text.toLowerCase();\r\n            alphabet = alphabet.toLowerCase();\r\n        }\r\n        var length = text.length;\r\n        var i;\r\n        var absBase = Math.abs(base);\r\n        var alphabetValues = {};\r\n        for (i = 0; i < alphabet.length; i++) {\r\n            alphabetValues[alphabet[i]] = i;\r\n        }\r\n        for (i = 0; i < length; i++) {\r\n            var c = text[i];\r\n            if (c === \"-\") continue;\r\n            if (c in alphabetValues) {\r\n                if (alphabetValues[c] >= absBase) {\r\n                    if (c === \"1\" && absBase === 1) continue;\r\n                    throw new Error(c + \" is not a valid digit in base \" + base + \".\");\r\n                }\r\n            }\r\n        }\r\n        base = parseValue(base);\r\n        var digits = [];\r\n        var isNegative = text[0] === \"-\";\r\n        for (i = isNegative ? 1 : 0; i < text.length; i++) {\r\n            var c = text[i];\r\n            if (c in alphabetValues) digits.push(parseValue(alphabetValues[c]));\r\n            else if (c === \"<\") {\r\n                var start = i;\r\n                do { i++; } while (text[i] !== \">\" && i < text.length);\r\n                digits.push(parseValue(text.slice(start + 1, i)));\r\n            }\r\n            else throw new Error(c + \" is not a valid character\");\r\n        }\r\n        return parseBaseFromArray(digits, base, isNegative);\r\n    };\r\n\r\n    function parseBaseFromArray(digits, base, isNegative) {\r\n        var val = Integer[0], pow = Integer[1], i;\r\n        for (i = digits.length - 1; i >= 0; i--) {\r\n            val = val.add(digits[i].times(pow));\r\n            pow = pow.times(base);\r\n        }\r\n        return isNegative ? val.negate() : val;\r\n    }\r\n\r\n    function stringify(digit, alphabet) {\r\n        alphabet = alphabet || DEFAULT_ALPHABET;\r\n        if (digit < alphabet.length) {\r\n            return alphabet[digit];\r\n        }\r\n        return \"<\" + digit + \">\";\r\n    }\r\n\r\n    function toBase(n, base) {\r\n        base = bigInt(base);\r\n        if (base.isZero()) {\r\n            if (n.isZero()) return { value: [0], isNegative: false };\r\n            throw new Error(\"Cannot convert nonzero numbers to base 0.\");\r\n        }\r\n        if (base.equals(-1)) {\r\n            if (n.isZero()) return { value: [0], isNegative: false };\r\n            if (n.isNegative())\r\n                return {\r\n                    value: [].concat.apply([], Array.apply(null, Array(-n.toJSNumber()))\r\n                        .map(Array.prototype.valueOf, [1, 0])\r\n                    ),\r\n                    isNegative: false\r\n                };\r\n\r\n            var arr = Array.apply(null, Array(n.toJSNumber() - 1))\r\n                .map(Array.prototype.valueOf, [0, 1]);\r\n            arr.unshift([1]);\r\n            return {\r\n                value: [].concat.apply([], arr),\r\n                isNegative: false\r\n            };\r\n        }\r\n\r\n        var neg = false;\r\n        if (n.isNegative() && base.isPositive()) {\r\n            neg = true;\r\n            n = n.abs();\r\n        }\r\n        if (base.isUnit()) {\r\n            if (n.isZero()) return { value: [0], isNegative: false };\r\n\r\n            return {\r\n                value: Array.apply(null, Array(n.toJSNumber()))\r\n                    .map(Number.prototype.valueOf, 1),\r\n                isNegative: neg\r\n            };\r\n        }\r\n        var out = [];\r\n        var left = n, divmod;\r\n        while (left.isNegative() || left.compareAbs(base) >= 0) {\r\n            divmod = left.divmod(base);\r\n            left = divmod.quotient;\r\n            var digit = divmod.remainder;\r\n            if (digit.isNegative()) {\r\n                digit = base.minus(digit).abs();\r\n                left = left.next();\r\n            }\r\n            out.push(digit.toJSNumber());\r\n        }\r\n        out.push(left.toJSNumber());\r\n        return { value: out.reverse(), isNegative: neg };\r\n    }\r\n\r\n    function toBaseString(n, base, alphabet) {\r\n        var arr = toBase(n, base);\r\n        return (arr.isNegative ? \"-\" : \"\") + arr.value.map(function (x) {\r\n            return stringify(x, alphabet);\r\n        }).join('');\r\n    }\r\n\r\n    BigInteger.prototype.toArray = function (radix) {\r\n        return toBase(this, radix);\r\n    };\r\n\r\n    SmallInteger.prototype.toArray = function (radix) {\r\n        return toBase(this, radix);\r\n    };\r\n\r\n    NativeBigInt.prototype.toArray = function (radix) {\r\n        return toBase(this, radix);\r\n    };\r\n\r\n    BigInteger.prototype.toString = function (radix, alphabet) {\r\n        if (radix === undefined) radix = 10;\r\n        if (radix !== 10) return toBaseString(this, radix, alphabet);\r\n        var v = this.value, l = v.length, str = String(v[--l]), zeros = \"0000000\", digit;\r\n        while (--l >= 0) {\r\n            digit = String(v[l]);\r\n            str += zeros.slice(digit.length) + digit;\r\n        }\r\n        var sign = this.sign ? \"-\" : \"\";\r\n        return sign + str;\r\n    };\r\n\r\n    SmallInteger.prototype.toString = function (radix, alphabet) {\r\n        if (radix === undefined) radix = 10;\r\n        if (radix != 10) return toBaseString(this, radix, alphabet);\r\n        return String(this.value);\r\n    };\r\n\r\n    NativeBigInt.prototype.toString = SmallInteger.prototype.toString;\r\n\r\n    NativeBigInt.prototype.toJSON = BigInteger.prototype.toJSON = SmallInteger.prototype.toJSON = function () { return this.toString(); }\r\n\r\n    BigInteger.prototype.valueOf = function () {\r\n        return parseInt(this.toString(), 10);\r\n    };\r\n    BigInteger.prototype.toJSNumber = BigInteger.prototype.valueOf;\r\n\r\n    SmallInteger.prototype.valueOf = function () {\r\n        return this.value;\r\n    };\r\n    SmallInteger.prototype.toJSNumber = SmallInteger.prototype.valueOf;\r\n    NativeBigInt.prototype.valueOf = NativeBigInt.prototype.toJSNumber = function () {\r\n        return parseInt(this.toString(), 10);\r\n    }\r\n\r\n    function parseStringValue(v) {\r\n        if (isPrecise(+v)) {\r\n            var x = +v;\r\n            if (x === truncate(x))\r\n                return supportsNativeBigInt ? new NativeBigInt(BigInt(x)) : new SmallInteger(x);\r\n            throw new Error(\"Invalid integer: \" + v);\r\n        }\r\n        var sign = v[0] === \"-\";\r\n        if (sign) v = v.slice(1);\r\n        var split = v.split(/e/i);\r\n        if (split.length > 2) throw new Error(\"Invalid integer: \" + split.join(\"e\"));\r\n        if (split.length === 2) {\r\n            var exp = split[1];\r\n            if (exp[0] === \"+\") exp = exp.slice(1);\r\n            exp = +exp;\r\n            if (exp !== truncate(exp) || !isPrecise(exp)) throw new Error(\"Invalid integer: \" + exp + \" is not a valid exponent.\");\r\n            var text = split[0];\r\n            var decimalPlace = text.indexOf(\".\");\r\n            if (decimalPlace >= 0) {\r\n                exp -= text.length - decimalPlace - 1;\r\n                text = text.slice(0, decimalPlace) + text.slice(decimalPlace + 1);\r\n            }\r\n            if (exp < 0) throw new Error(\"Cannot include negative exponent part for integers\");\r\n            text += (new Array(exp + 1)).join(\"0\");\r\n            v = text;\r\n        }\r\n        var isValid = /^([0-9][0-9]*)$/.test(v);\r\n        if (!isValid) throw new Error(\"Invalid integer: \" + v);\r\n        if (supportsNativeBigInt) {\r\n            return new NativeBigInt(BigInt(sign ? \"-\" + v : v));\r\n        }\r\n        var r = [], max = v.length, l = LOG_BASE, min = max - l;\r\n        while (max > 0) {\r\n            r.push(+v.slice(min, max));\r\n            min -= l;\r\n            if (min < 0) min = 0;\r\n            max -= l;\r\n        }\r\n        trim(r);\r\n        return new BigInteger(r, sign);\r\n    }\r\n\r\n    function parseNumberValue(v) {\r\n        if (supportsNativeBigInt) {\r\n            return new NativeBigInt(BigInt(v));\r\n        }\r\n        if (isPrecise(v)) {\r\n            if (v !== truncate(v)) throw new Error(v + \" is not an integer.\");\r\n            return new SmallInteger(v);\r\n        }\r\n        return parseStringValue(v.toString());\r\n    }\r\n\r\n    function parseValue(v) {\r\n        if (typeof v === \"number\") {\r\n            return parseNumberValue(v);\r\n        }\r\n        if (typeof v === \"string\") {\r\n            return parseStringValue(v);\r\n        }\r\n        if (typeof v === \"bigint\") {\r\n            return new NativeBigInt(v);\r\n        }\r\n        return v;\r\n    }\r\n    // Pre-define numbers in range [-999,999]\r\n    for (var i = 0; i < 1000; i++) {\r\n        Integer[i] = parseValue(i);\r\n        if (i > 0) Integer[-i] = parseValue(-i);\r\n    }\r\n    // Backwards compatibility\r\n    Integer.one = Integer[1];\r\n    Integer.zero = Integer[0];\r\n    Integer.minusOne = Integer[-1];\r\n    Integer.max = max;\r\n    Integer.min = min;\r\n    Integer.gcd = gcd;\r\n    Integer.lcm = lcm;\r\n    Integer.isInstance = function (x) { return x instanceof BigInteger || x instanceof SmallInteger || x instanceof NativeBigInt; };\r\n    Integer.randBetween = randBetween;\r\n\r\n    Integer.fromArray = function (digits, base, isNegative) {\r\n        return parseBaseFromArray(digits.map(parseValue), parseValue(base || 10), isNegative);\r\n    };\r\n\r\n    return Integer;\r\n})();\r\n\r\n// Node.js check\r\nif (typeof module !== \"undefined\" && module.hasOwnProperty(\"exports\")) {\r\n    module.exports = bigInt;\r\n}\r\n\r\n//amd check\r\nif (typeof define === \"function\" && define.amd) {\r\n    define( function () {\r\n        return bigInt;\r\n    });\r\n}\r\n"]},"metadata":{},"sourceType":"script"}