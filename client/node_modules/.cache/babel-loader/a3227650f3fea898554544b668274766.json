{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  result[\"default\"] = mod;\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst TezosConseilClient_1 = require(\"../../reporting/tezos/TezosConseilClient\");\n\nconst TezosLanguageUtil_1 = require(\"./TezosLanguageUtil\");\n\nconst EntryPointTemplate = __importStar(require(\"./lexer/EntryPointTemplate\"));\n\nconst nearley = __importStar(require(\"nearley\"));\n\nvar TezosContractIntrospector;\n\n(function (TezosContractIntrospector) {\n  function generateEntryPointsFromParams(params) {\n    const parser = new nearley.Parser(nearley.Grammar.fromCompiled(EntryPointTemplate.default));\n    parser.feed(TezosLanguageUtil_1.TezosLanguageUtil.normalizeMichelineWhiteSpace(TezosLanguageUtil_1.TezosLanguageUtil.stripComments(params)));\n    const entryPoints = parser.results[0];\n\n    if (entryPoints.length === 1) {\n      entryPoints[0].name = 'default';\n    }\n\n    return entryPoints;\n  }\n\n  TezosContractIntrospector.generateEntryPointsFromParams = generateEntryPointsFromParams;\n\n  function generateEntryPointsFromCode(contractCode) {\n    const contractParameter = TezosLanguageUtil_1.TezosLanguageUtil.preProcessMichelsonScript(contractCode)[0];\n    return generateEntryPointsFromParams(contractParameter);\n  }\n\n  TezosContractIntrospector.generateEntryPointsFromCode = generateEntryPointsFromCode;\n\n  function generateEntryPointsFromAddress(conseilServer, network, contractAddress) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const account = yield TezosConseilClient_1.TezosConseilClient.getAccount(conseilServer, network, contractAddress);\n      const contractCode = account.script;\n      return generateEntryPointsFromCode(contractCode);\n    });\n  }\n\n  TezosContractIntrospector.generateEntryPointsFromAddress = generateEntryPointsFromAddress;\n})(TezosContractIntrospector = exports.TezosContractIntrospector || (exports.TezosContractIntrospector = {}));","map":{"version":3,"sources":["../../../src/chain/tezos/TezosContractIntrospector.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAA,oBAAA,GAAA,OAAA,CAAA,0CAAA,CAAA;;AACA,MAAA,mBAAA,GAAA,OAAA,CAAA,qBAAA,CAAA;;AAGA,MAAA,kBAAA,GAAA,YAAA,CAAA,OAAA,CAAA,4BAAA,CAAA,CAAA;;AACA,MAAA,OAAA,GAAA,YAAA,CAAA,OAAA,CAAA,SAAA,CAAA,CAAA;;AAKA,IAAiB,yBAAjB;;AAAA,CAAA,UAAiB,yBAAjB,EAA0C;AAOtC,WAAgB,6BAAhB,CAA8C,MAA9C,EAA4D;AACxD,UAAM,MAAM,GAAmB,IAAI,OAAO,CAAC,MAAZ,CAAmB,OAAO,CAAC,OAAR,CAAgB,YAAhB,CAA6B,kBAAkB,CAAC,OAAhD,CAAnB,CAA/B;AACA,IAAA,MAAM,CAAC,IAAP,CAAY,mBAAA,CAAA,iBAAA,CAAkB,4BAAlB,CAA+C,mBAAA,CAAA,iBAAA,CAAkB,aAAlB,CAAgC,MAAhC,CAA/C,CAAZ;AAEA,UAAM,WAAW,GAAG,MAAM,CAAC,OAAP,CAAe,CAAf,CAApB;;AAEA,QAAI,WAAW,CAAC,MAAZ,KAAuB,CAA3B,EAA8B;AAC1B,MAAA,WAAW,CAAC,CAAD,CAAX,CAAe,IAAf,GAAsB,SAAtB;AACH;;AAED,WAAO,WAAP;AACH;;AAXe,EAAA,yBAAA,CAAA,6BAAA,GAA6B,6BAA7B;;AAmBhB,WAAgB,2BAAhB,CAA4C,YAA5C,EAAgE;AAC5D,UAAM,iBAAiB,GAAW,mBAAA,CAAA,iBAAA,CAAkB,yBAAlB,CAA4C,YAA5C,EAA0D,CAA1D,CAAlC;AACA,WAAO,6BAA6B,CAAC,iBAAD,CAApC;AACH;;AAHe,EAAA,yBAAA,CAAA,2BAAA,GAA2B,2BAA3B;;AAahB,WAAsB,8BAAtB,CAAqD,aAArD,EAAuF,OAAvF,EAAwG,eAAxG,EAA+H;;AAC3H,YAAM,OAAO,GAAG,MAAM,oBAAA,CAAA,kBAAA,CAAmB,UAAnB,CAA8B,aAA9B,EAA6C,OAA7C,EAAsD,eAAtD,CAAtB;AACA,YAAM,YAAY,GAAW,OAAO,CAAC,MAArC;AACA,aAAO,2BAA2B,CAAC,YAAD,CAAlC;AACH,K;AAAA;;AAJqB,EAAA,yBAAA,CAAA,8BAAA,GAA8B,8BAA9B;AAKzB,CA5CD,EAAiB,yBAAyB,GAAzB,OAAA,CAAA,yBAAA,KAAA,OAAA,CAAA,yBAAA,GAAyB,EAAzB,CAAjB","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst TezosConseilClient_1 = require(\"../../reporting/tezos/TezosConseilClient\");\nconst TezosLanguageUtil_1 = require(\"./TezosLanguageUtil\");\nconst EntryPointTemplate = __importStar(require(\"./lexer/EntryPointTemplate\"));\nconst nearley = __importStar(require(\"nearley\"));\nvar TezosContractIntrospector;\n(function (TezosContractIntrospector) {\n    function generateEntryPointsFromParams(params) {\n        const parser = new nearley.Parser(nearley.Grammar.fromCompiled(EntryPointTemplate.default));\n        parser.feed(TezosLanguageUtil_1.TezosLanguageUtil.normalizeMichelineWhiteSpace(TezosLanguageUtil_1.TezosLanguageUtil.stripComments(params)));\n        const entryPoints = parser.results[0];\n        if (entryPoints.length === 1) {\n            entryPoints[0].name = 'default';\n        }\n        return entryPoints;\n    }\n    TezosContractIntrospector.generateEntryPointsFromParams = generateEntryPointsFromParams;\n    function generateEntryPointsFromCode(contractCode) {\n        const contractParameter = TezosLanguageUtil_1.TezosLanguageUtil.preProcessMichelsonScript(contractCode)[0];\n        return generateEntryPointsFromParams(contractParameter);\n    }\n    TezosContractIntrospector.generateEntryPointsFromCode = generateEntryPointsFromCode;\n    function generateEntryPointsFromAddress(conseilServer, network, contractAddress) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const account = yield TezosConseilClient_1.TezosConseilClient.getAccount(conseilServer, network, contractAddress);\n            const contractCode = account.script;\n            return generateEntryPointsFromCode(contractCode);\n        });\n    }\n    TezosContractIntrospector.generateEntryPointsFromAddress = generateEntryPointsFromAddress;\n})(TezosContractIntrospector = exports.TezosContractIntrospector || (exports.TezosContractIntrospector = {}));\n//# sourceMappingURL=TezosContractIntrospector.js.map"]},"metadata":{},"sourceType":"script"}